<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="20cc14aa-7246-4671-a658-6dab248d820a" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="validateCruiseBooking" searchProperties="true" timeout="0" maxResults="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="20cc14aa-7246-4671-a658-6dab248d820afileName">validateCruiseBooking</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="datasource" name="DataSource" id="192ff775-c9f8-4ba4-b783-06ad0d484e12">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="Excel">
        <con:configuration>
          <file>Booking_REST_Input.xls</file>
          <worksheet>validateCruiseBooking</worksheet>
          <cell>A2</cell>
          <ignoreEmpty>false</ignoreEmpty>
          <evaluateFormulas>false</evaluateFormulas>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>S.No</con:property>
      <con:property>ServiceName</con:property>
      <con:property>Operation Name</con:property>
      <con:property>ExecutionFlag</con:property>
      <con:property>TestCaseName</con:property>
      <con:property>TestCaseDescription</con:property>
      <con:property>application</con:property>
      <con:property>brand</con:property>
      <con:property>domainId</con:property>
      <con:property>language</con:property>
      <con:property>uuid</con:property>
      <con:startRow>2</con:startRow>
      <con:endRow>2</con:endRow>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="DataSource1" id="d533cb40-e3c2-4268-952b-522711675d75">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="Excel">
        <con:configuration>
          <file>Booking_REST_Input.xls</file>
          <worksheet>validateCruiseBooking</worksheet>
          <cell>A2</cell>
          <ignoreEmpty>false</ignoreEmpty>
          <evaluateFormulas>false</evaluateFormulas>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>S.No</con:property>
      <con:property>ServiceName</con:property>
      <con:property>Operation Name</con:property>
      <con:property>ExecutionFlag</con:property>
      <con:property>TestCaseName</con:property>
      <con:property>TestCaseDescription</con:property>
      <con:property>application</con:property>
      <con:property>brand</con:property>
      <con:property>domainId</con:property>
      <con:property>language</con:property>
      <con:property>uuid</con:property>
      <con:startRow>0</con:startRow>
      <con:endRow>0</con:endRow>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="properties" name="BookingId's for celebrity" id="c3c9427e-8a00-43f3-a0f3-1f4988440321">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>BOOKINGID</con:name>
          <con:value>78927</con:value>
        </con:property>
        <con:property>
          <con:name>BOOKINGID1</con:name>
          <con:value>726771</con:value>
        </con:property>
        <con:property>
          <con:name>BOOKINGID2</con:name>
          <con:value>727444</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="properties" name="Properties 1" id="5625d36b-9149-41ce-a6f9-56f64e42b15a">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>BOOKINGID1</con:name>
          <con:value>70014</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="properties" name="Properties 2" id="85493e35-7ebd-42a6-b8dd-a07799939aba">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>BOOKINGID2</con:name>
          <con:value>77085</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="properties" name="Properties 3" id="e68a529c-8a1e-407a-a543-092437f33835">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>BOOKINGID3</con:name>
          <con:value>709502</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="jdbc" name="JDBC Request" id="11048035-8a2a-488e-94c9-4796862cab01">
    <con:settings>
      <con:setting id="prettyPrintResponse">true</con:setting>
    </con:settings>
    <con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:driver>com.microsoft.sqlserver.jdbc.SQLServerDriver</con:driver>
      <con:connectionString>jdbc:sqlserver://WINSQLSCLDB01.RCCL.COM:14725;databaseName=WebRemoteDataAccess_PBND;user=b2c_user;password=PASS_VALUE</con:connectionString>
      <con:password>b2c_user</con:password>
      <con:connectionProperties/>
      <con:query>SELECT DISTINCT TOP 100 
  booking.BVBKID AS bookingId
  FROM AS400_Mirror.dbo.RZBKVD booking
  INNER JOIN AS400_Mirror.dbo.RZPITD guestInfo (nolock)
  ON booking.BVBKID = guestInfo.ABBKID 
  AND guestInfo.ABPSTA = 'AC'  
  LEFT OUTER JOIN AS400_Mirror.dbo.RZINAD a (nolock)
  ON booking.BVBKID = a.NWIAID 
  LEFT OUTER JOIN AS400_Mirror.dbo.RZGRAD b (nolock)
  ON booking.BVGAID = b.BDGAID 
  WHERE booking.BVSDDT = 1191201 AND
  booking.BVSHIP = 'AL' AND
  booking.BVBKID LIKE '7%'</con:query>
      <con:assertion type="XPath Match" id="8bc88815-bc3a-4683-98f1-7d3f1c0cadba" name="Match content of [@rowNumber]">
        <con:configuration>
          <path>//Results[1]/ResultSet[1]/Row[1]/@rowNumber</path>
          <content>1</content>
          <allowWildcards>false</allowWildcards>
          <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
          <ignoreComments>false</ignoreComments>
        </con:configuration>
      </con:assertion>
      <con:properties/>
    </con:config>
  </con:testStep>
  <con:testStep type="transfer" name="PropertyTransfer 3" id="64cc5167-0ef6-4dd6-93bd-bf1f4b74771a">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>BOOKINGID</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>JDBC Request</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[3]/BOOKINGID[1]</con:sourcePath>
        <con:targetType>BOOKINGID3</con:targetType>
        <con:targetStep>Properties 3</con:targetStep>
        <con:targetPath/>
        <con:type>XPATH</con:type>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep type="transfer" name="PropertyTransfer 2" id="d9f6081d-43ea-4111-b52b-6b6c3c676b5b">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>BOOKINGID</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>JDBC Request</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[2]/BOOKINGID[1]</con:sourcePath>
        <con:targetType>BOOKINGID2</con:targetType>
        <con:targetStep>Properties 2</con:targetStep>
        <con:targetPath/>
        <con:type>XPATH</con:type>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep type="transfer" name="PropertyTransfer 1" id="3aa0a740-6ec2-4fb8-9eeb-a4971457f3ed">
    <con:settings/>
    <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
        <con:name>BOOKINGID</con:name>
        <con:sourceType>ResponseAsXml</con:sourceType>
        <con:sourceStep>JDBC Request</con:sourceStep>
        <con:sourcePath>//Results[1]/ResultSet[1]/Row[1]/BOOKINGID[1]</con:sourcePath>
        <con:targetType>BOOKINGID1</con:targetType>
        <con:targetStep>Properties 1</con:targetStep>
        <con:targetPath/>
        <con:type>XPATH</con:type>
        <con:upgraded>true</con:upgraded>
      </con:transfers>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="validateCruiseBooking with invalid bookingId" id="8b4cc831-3ccd-45a6-8732-539af2ca4d81">
    <con:settings/>
    <con:config service="Booking" methodName="POST" resourcePath="/cruisecritic/validateBatchBookings" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="validateCruiseBooking with invalid bookingId" id="7850a358-85a2-462b-99a0-c05407624345" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="AppKey" value="${#Project#AppKey}" xmlns="http://eviware.com/soapui/config"/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>${#Global#Booking_REST_Endpoint}</con:endpoint>
        <con:request>{\r
   "header" : {\r
      "application" : "${DataSource1#application}",\r
      "language" : "${DataSource1#language}",\r
      "domainId" : "${DataSource1#domainId}",\r
      "brand" : "${DataSource1#brand}",\r
      "uuid" : ""\r
   },\r
   "cruiseBookingInfo" : {\r
      "bookingIds" : [\r
         "${Properties 1#BOOKINGID1}000",\r
         "",\r
         ""\r
      ]\r
   }\r
}</con:request>
        <con:originalUri>https://stg1-int.api.rccl.com/esl/booking/stg1/rest/v3/validateCruiseBooking</con:originalUri>
        <con:assertion type="JsonPath Match" id="56eac3e2-def5-407a-a73f-061fc8ba7465" name="Match content of [status]">
          <con:configuration>
            <path>$['header']['status']</path>
            <content>Failure</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:parameters/>
        <con:environmentSpec>
          <con:entry environmentId="05d1995b-507d-4e9b-a0ae-b4b3914430c6">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="c664df8a-1bc9-4fd0-b9df-f335d0d1d097">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="6487e236-41f2-4f62-890c-d58853f938d8">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="b7e2c48e-a234-4c1b-b92c-fa60171fbaa6">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="755bdcf9-70a8-4132-844d-e5cd8d24e80c">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="47074864-6f72-4d97-bae4-21c8ed49aa75">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="b90fdab2-9475-4f32-8f02-297fa386bc5c">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="30e190d4-5cca-4b41-a9d3-1723c6ff34d4">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="361d8992-6d1c-42db-abc6-a3db88088a91">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="4ffc1287-e3e9-4aba-aa44-a81cbddd261a">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="validateCruiseBooking with blank bookingId" id="256f31fa-95eb-4a31-8608-4ee09c300f49">
    <con:settings/>
    <con:config service="Booking" methodName="POST" resourcePath="/cruisecritic/validateBatchBookings" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="validateCruiseBooking with blank bookingId" id="7850a358-85a2-462b-99a0-c05407624345" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="AppKey" value="${#Project#AppKey}" xmlns="http://eviware.com/soapui/config"/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>${#Global#Booking_REST_Endpoint}</con:endpoint>
        <con:request>{\r
   "header" : {\r
      "application" : "${DataSource1#application}",\r
      "language" : "${DataSource1#language}",\r
      "domainId" : "${DataSource1#domainId}",\r
      "brand" : "${DataSource1#brand}",\r
      "uuid" : ""\r
   },\r
   "cruiseBookingInfo" : {\r
      "bookingIds" : [\r
         "",\r
         "",\r
         ""\r
      ]\r
   }\r
}</con:request>
        <con:originalUri>https://stg1-int.api.rccl.com/esl/booking/stg1/rest/v3/validateCruiseBooking</con:originalUri>
        <con:assertion type="JsonPath Match" id="56eac3e2-def5-407a-a73f-061fc8ba7465" name="Match content of [status]">
          <con:configuration>
            <path>$['header']['status']</path>
            <content>Failure</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="0aca1eb1-1277-40a2-ae7a-ba1725206952" name="Match content of [code]">
          <con:configuration>
            <path>$['header']['error'][0]['code']</path>
            <content>BKNG-0001</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:parameters/>
        <con:environmentSpec>
          <con:entry environmentId="05d1995b-507d-4e9b-a0ae-b4b3914430c6">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="c664df8a-1bc9-4fd0-b9df-f335d0d1d097">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="6487e236-41f2-4f62-890c-d58853f938d8">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="b7e2c48e-a234-4c1b-b92c-fa60171fbaa6">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="755bdcf9-70a8-4132-844d-e5cd8d24e80c">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="47074864-6f72-4d97-bae4-21c8ed49aa75">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="b90fdab2-9475-4f32-8f02-297fa386bc5c">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="30e190d4-5cca-4b41-a9d3-1723c6ff34d4">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="361d8992-6d1c-42db-abc6-a3db88088a91">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
          <con:entry environmentId="4ffc1287-e3e9-4aba-aa44-a81cbddd261a">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>PackageCode</con:name>
      <con:value>AD06N002</con:value>
    </con:property>
    <con:property>
      <con:name>ShipCode</con:name>
      <con:value>AD</con:value>
    </con:property>
    <con:property>
      <con:name>SailDate</con:name>
      <con:value>2019-06-08</con:value>
    </con:property>
    <con:property>
      <con:name>FareCode</con:name>
      <con:value>E5768893</con:value>
    </con:property>
    <con:property>
      <con:name>Category</con:name>
      <con:value>4V</con:value>
    </con:property>
    <con:property>
      <con:name>CabinNumber</con:name>
      <con:value>8679</con:value>
    </con:property>
    <con:property>
      <con:name>AccessToken</con:name>
      <con:value>e7b724bf-eb36-407e-a06f-7bc06bfb696d</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>ab713861-6501-4534-8dc5-bc318c0b5400</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>c682267c-e6d4-4b01-8a66-211b1f74a44b</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>c5a46c07-1472-4905-a066-8e24c3088dbd</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>725f2f05-1102-47e5-a30d-f7be64f5e39b</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>ee0fbe95-bba4-41de-97ba-00401f947cf8</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>e6871cf9-4da6-4e05-93f4-75ae405ab1e4</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>2189b245-c664-43ed-8fcf-212d6b91a3b0</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>86234b57-3091-4f15-8525-b1e2f33ec14a</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>d3fd72d7-dca3-41b0-8365-86a8448b6a9a</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>5d1b4be4-d4ff-41ff-8e52-290f57bd1a55</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>dbb16df0-ef89-41bc-9830-fcac8ff7c030</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>d533cb40-e3c2-4268-952b-522711675d75</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
