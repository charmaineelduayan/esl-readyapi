<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="aef63bb7-966e-4176-9d3d-ef67d1826b43" created="3.41.1" activeEnvironment="RLE" name="ESL QA" updated="3.42.0 2022-11-03T12:31:09Z" encryptionMode="Not encrypted" projectVersion="e8f04271-96cf-4fae-80f3-d047bac18f50" resourceRoot="" xmlns:con="http://eviware.com/soapui/config">
  <con:settings/>
  <con:interface xsi:type="con:RestService" id="d92c4663-9879-4dd1-9662-2d2fccba2539" name="Cruise Search" type="rest_ex" wadlVersion="https://swagger.io/openapiv3/specification" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart="Cruise Search.json">
      <con:part>
        <con:url>Cruise Search.json</con:url>
        <con:content>{"openapi":"3.0.1","info":{"title":"Cruise Search","version":"1.0.0"},"servers":[{"url":"/"}],"paths":{"/esl/search/rest/cruiseSearch":{"description":"","get":{"description":"","responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"criteria.channel","in":"query"},{"name":"criteria.bookingType","in":"query"},{"name":"header.domainId","in":"query"},{"name":"header.language","in":"query"},{"name":"header.application","in":"query"},{"name":"criteria.brand.value","in":"query"},{"name":"criteria.ship.value","in":"query"},{"name":"criteria.cruiseType.value","in":"query"},{"name":"criteria.office","in":"query"},{"name":"criteria.country","in":"query"},{"name":"criteria.currency","in":"query"},{"name":"criteria.occupancy.adult","in":"query"},{"name":"resultsPreference.pagination.offset","in":"query"},{"name":"resultsPreference.pagination.count","in":"query"},{"name":"resultsPreference.strictSearch","in":"query"},{"name":"resultsPreference.sortBy","in":"query"},{"name":"resultsPreference.sortOrder","in":"query"},{"name":"resultsPreference.groupBy","in":"query"},{"name":"resultsPreference.includeResults","in":"query"},{"name":"resultsPreference.includeOnlyIfPriceAvailable","in":"query"},{"name":"resultsPreference.priceLevel.bestPricedCategory","in":"query"},{"name":"resultsPreference.includePrices","in":"query"},{"name":"qualifiers.priceScope","in":"query"},{"name":"qualifiers.qualifierScope","in":"query"},{"name":"qualifiers.offersType.strictPricingFlag","in":"query"}]}}}</con:content>
        <con:type>https://swagger.io/openapiv3/specification</con:type>
      </con:part>
    </con:definitionCache>
    <con:endpoints/>
    <con:environmentSpec>
      <con:entry environmentId="1e8db791-2cca-4d3a-9451-5c9a433740b4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
      <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="cruiseSearch" path="/esl/search/rest/cruiseSearch" id="e1be14ed-aa79-4885-bf20-c4b7eb52520b">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>criteria.channel</con:name>
          <con:value>VP</con:value>
          <con:style>QUERY</con:style>
          <con:default>VP</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.bookingType</con:name>
          <con:value>FIT</con:value>
          <con:style>QUERY</con:style>
          <con:default>FIT</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_us</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_us</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>celebritycruises.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>celebritycruises.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.brand.value</con:name>
          <con:value>C</con:value>
          <con:style>QUERY</con:style>
          <con:default>C</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.ship.value</con:name>
          <con:value>ML</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.cruiseType.value</con:name>
          <con:value>CO</con:value>
          <con:style>QUERY</con:style>
          <con:default>CO</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.office</con:name>
          <con:value>MIA</con:value>
          <con:style>QUERY</con:style>
          <con:default>MIA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.country</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.currency</con:name>
          <con:value>USD</con:value>
          <con:style>QUERY</con:style>
          <con:default>USD</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>criteria.occupancy.adult</con:name>
          <con:value>2</con:value>
          <con:style>QUERY</con:style>
          <con:default>2</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.pagination.offset</con:name>
          <con:value>0</con:value>
          <con:style>QUERY</con:style>
          <con:default>0</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.pagination.count</con:name>
          <con:value>100</con:value>
          <con:style>QUERY</con:style>
          <con:default>100</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.strictSearch</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.sortBy</con:name>
          <con:value>DURATION</con:value>
          <con:style>QUERY</con:style>
          <con:default>DURATION</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.sortOrder</con:name>
          <con:value>DESCENDING</con:value>
          <con:style>QUERY</con:style>
          <con:default>DESCENDING</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.groupBy</con:name>
          <con:value>PACKAGE</con:value>
          <con:style>QUERY</con:style>
          <con:default>PACKAGE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.includeResults</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.includeOnlyIfPriceAvailable</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.priceLevel.bestPricedCategory</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>resultsPreference.includePrices</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>qualifiers.priceScope</con:name>
          <con:value>REQUESTED_AVAILABLE</con:value>
          <con:style>QUERY</con:style>
          <con:default>REQUESTED_AVAILABLE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>qualifiers.qualifierScope</con:name>
          <con:value>SEARCH_AND_PRICE</con:value>
          <con:style>QUERY</con:style>
          <con:default>SEARCH_AND_PRICE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>qualifiers.offersType.strictPricingFlag</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="cruiseSearch" id="b8b8376d-b4f7-4d47-9736-20c1088ec6cb" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="cruiseSearch_REQ1" id="3efd27a3-c060-4ccb-8337-cd10c6b4e444" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:request/>
          <con:originalUri>http://eslaservicestst01.rccl.com/esl/booking/tst2/esl/search/rest/cruiseSearch</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="dcf98ac9-f4a4-4280-b720-e8af75e589ba" name="Booking" type="rest_ex" wadlVersion="https://swagger.io/openapiv3/specification" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart="Booking.json">
      <con:part>
        <con:url>Booking.json</con:url>
        <con:content>{"openapi":"3.0.1","info":{"title":"Booking","version":"1.0.0"},"servers":[{"url":"/"}],"paths":{"/rest/v3/retrieveStateroomsForCategory":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"header.domainId","in":"query","required":false,"style":"form","explode":true},{"name":"header.language","in":"query","required":false,"style":"form","explode":true},{"name":"header.application","in":"query","required":false,"style":"form","explode":true},{"name":"header.brand","in":"query","required":false,"style":"form","explode":true},{"name":"shipCode","in":"query","required":false,"style":"form","explode":true},{"name":"sailDate","in":"query","required":false,"style":"form","explode":true},{"name":"packageId","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"currency","in":"query","required":false,"style":"form","explode":true},{"name":"categoryCode","in":"query","required":false,"style":"form","explode":true},{"name":"stateroomOccupancy.guestAge","in":"query","required":false,"style":"form","explode":true},{"name":"stateroomOccupancy.fareCode","in":"query","required":false,"style":"form","explode":true},{"name":"stateroomOccupancy.seniorReqd","in":"query","required":false,"style":"form","explode":true},{"name":"stateroomOccupancy.accessibleReqd","in":"query","required":false,"style":"form","explode":true}]},"/rest/v3/retrieveStateroomOffers":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"header.domainId","in":"query","required":false,"style":"form","explode":true},{"name":"header.language","in":"query","required":false,"style":"form","explode":true},{"name":"header.application","in":"query","required":false,"style":"form","explode":true},{"name":"header.brand","in":"query","required":false,"style":"form","explode":true},{"name":"shipCode","in":"query","required":false,"style":"form","explode":true},{"name":"sailDate","in":"query","required":false,"style":"form","explode":true},{"name":"packageId","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"currency","in":"query","required":false,"style":"form","explode":true},{"name":"guestAge","in":"query","required":false,"style":"form","explode":true},{"name":"accessibleReqd","in":"query","required":false,"style":"form","explode":true},{"name":"seniorReqd","in":"query","required":false,"style":"form","explode":true},{"name":"militaryReqd","in":"query","required":false,"style":"form","explode":true},{"name":"policeReqd","in":"query","required":false,"style":"form","explode":true},{"name":"fireFighterReqd","in":"query","required":false,"style":"form","explode":true},{"name":"stateCode","in":"query","required":false,"style":"form","explode":true},{"name":"loyaltyId","in":"query","required":false,"style":"form","explode":true},{"name":"couponCode","in":"query","required":false,"style":"form","explode":true},{"name":"includeNonRefundablePromos","in":"query","required":false,"style":"form","explode":true},{"name":"includePromoBreakdown","in":"query","required":false,"style":"form","explode":true}]},"/rest/v3/bookingAddOns":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"header.domainId","in":"query","required":false,"style":"form","explode":true},{"name":"header.language","in":"query","required":false,"style":"form","explode":true},{"name":"header.application","in":"query","required":false,"style":"form","explode":true},{"name":"header.brand","in":"query","required":false,"style":"form","explode":true},{"name":"shipCode","in":"query","required":false,"style":"form","explode":true},{"name":"sailDate","in":"query","required":false,"style":"form","explode":true},{"name":"packageId","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"currency","in":"query","required":false,"style":"form","explode":true},{"name":"berthCategoryCd","in":"query","required":false,"style":"form","explode":true},{"name":"cabinNumber","in":"query","required":false,"style":"form","explode":true},{"name":"guestAge","in":"query","required":false,"style":"form","explode":true},{"name":"pricingPgmCd","in":"query","required":false,"style":"form","explode":true},{"name":"returnInfo.specialServices","in":"query","required":false,"style":"form","explode":true},{"name":"returnInfo.diningOptions","in":"query","required":false,"style":"form","explode":true}]},"/rest/v3/retrievePaymentHistory":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"header.application","in":"query","required":false,"style":"form","explode":true},{"name":"header.brand","in":"query","required":false,"style":"form","explode":true},{"name":"header.domainId","in":"query","required":false,"style":"form","explode":true},{"name":"header.language","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"agencyId","in":"query","required":false,"style":"form","explode":true},{"name":"bookingId","in":"query","required":false,"style":"form","explode":true},{"name":"bookingAccessToken","in":"query","required":false,"style":"form","explode":true},{"name":"shipCode","in":"query","required":false,"style":"form","explode":true},{"name":"sailDate","in":"query","required":false,"style":"form","explode":true}]},"/rest/v3/releaseBooking":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"header.domainId","in":"query","required":false,"style":"form","explode":true},{"name":"header.language","in":"query","required":false,"style":"form","explode":true},{"name":"header.application","in":"query","required":false,"style":"form","explode":true},{"name":"header.brand","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"bookingId","in":"query","required":false,"style":"form","explode":true},{"name":"bookingAccessToken","in":"query","required":false,"style":"form","explode":true},{"name":"lockBooking","in":"query","required":false,"style":"form","explode":true}]},"/rest/v3/retrieveBooking":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"header.domainId","in":"query","required":false,"style":"form","explode":true},{"name":"header.language","in":"query","required":false,"style":"form","explode":true},{"name":"header.application","in":"query","required":false,"style":"form","explode":true},{"name":"header.brand","in":"query","required":false,"style":"form","explode":true},{"name":"shipCode","in":"query","required":false,"style":"form","explode":true},{"name":"sailDate","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"bookingId","in":"query","required":false,"style":"form","explode":true},{"name":"lastName","in":"query","required":false,"style":"form","explode":true},{"name":"lockBooking","in":"query","required":false,"style":"form","explode":true},{"name":"summaryRequested","in":"query","required":false,"style":"form","explode":true}]},"/rest/v3/createBooking":{"post":{"requestBody":{"content":{"application/json":{"example":"{\n   \"header\":{\n      \"application\":\"royalcaribbean.com\",\n      \"brand\":\"R\",\n      \"domainId\":\"1\",\n      \"language\":\"en_US\"\n   },\n   \"countryCode\":\"USA\",\n   \"sailingInfo\":{\n      \"shipCode\":\"ML\",\n      \"sailDate\":\"2023-01-14\",\n      \"packageCode\":\"ML07D316\",\n      \"currencyCode\":\"USD\"\n   },\n   \"reservations\":[\n      {\n         \"cabin\":{\n            \"berthedCategoryCode\":\"12\",\n            \"fareCode\":\"I1773897\",\n            \"pricedCategoryCode\":\"12\",\n            \"waitListed\":\"false\",\n            \"accessible\":\"false\",\n            \"number\":\"2135\"\n         },\n         \"dining\":[\n            {\n               \"sitting\":\"O\",\n               \"sittingType\":\"OPEN\",\n               \"sittingInstance\":\"\"\n            }\n         ],\n         \"gratuitiesPrepaid\":\"false\",\n         \"insurance\":{\n            \"code\":\"CRCR\",\n            \"optionIndicator\":\"false\"\n         },\n         \"fareQualifiers\":{\n            \"seniorReqd\":\"false\",\n            \"militaryReqd\":\"false\",\n            \"policeReqd\":\"false\",\n            \"fireFighterReqd\":\"false\"\n         },\n         \"guestDetails\":[\n            {\n               \"guestContact\":{\n                  \"guestRefNumber\":\"0\",\n                  \"personalInfo\":{\n                     \"name\":{\n                        \"title\":\"MS\",\n                        \"firstName\":\"qa one\",\n                        \"lastName\":\"Tester\"\n                     },\n                     \"age\":\"55\",\n                     \"birthDate\":\"1960-05-13\",\n                     \"gender\":\"F\",\n                     \"nationality\":\"USA\"\n                  },\n                  \"address\":{\n                     \"address1\":\"addr1\",\n                     \"city\":\"Miramar\",\n                     \"stateCode\":\"FL\",\n                     \"postalCode\":\"33029\",\n                     \"countryName\":\"USA\"\n                  },\n                  \"email\":\"eslqatester@rccl.com\"\n               }\n            },\n            {\n               \"guestContact\":{\n                  \"guestRefNumber\":\"0\",\n                  \"personalInfo\":{\n                     \"name\":{\n                        \"title\":\"MR\",\n                        \"firstName\":\"qa two\",\n                        \"lastName\":\"tester\"\n                     },\n                     \"age\":\"55\",\n                     \"birthDate\":\"1960-05-13\",\n                     \"gender\":\"M\",\n                     \"nationality\":\"USA\"\n                  },\n                  \"address\":{\n                     \"address1\":\"addr1\",\n                     \"city\":\"Miramar\",\n                     \"stateCode\":\"NA\",\n                     \"postalCode\":\"33029\",\n                     \"countryName\":\"USA\"\n                  },\n                  \"email\":\"eslqatester@rccl.com\"\n               }\n            }\n         ]\n         \n      }\n   ],\n   \"courtesyHold\":\"true\"\n}"}}},"responses":{"default":{"description":"Default response"}}}},"/en/c/web/v1/esl/promotions/bbb":{"get":{"responses":{"default":{"description":"Default response"}}},"parameters":[{"name":"domain","in":"query","required":false,"style":"form","explode":true},{"name":"currency","in":"query","required":false,"style":"form","explode":true},{"name":"countryCode","in":"query","required":false,"style":"form","explode":true},{"name":"includeNonRefundablePromos","in":"query","required":false,"style":"form","explode":true},{"name":"packageId","in":"query","required":false,"style":"form","explode":true},{"name":"sailDate","in":"query","required":false,"style":"form","explode":true},{"name":"shipCode","in":"query","required":false,"style":"form","explode":true},{"name":"categoryCode","in":"query","required":false,"style":"form","explode":true},{"name":"etl","in":"query","required":false,"style":"form","explode":true},{"name":"guestAge[0]","in":"query","required":false,"style":"form","explode":true},{"name":"guestAge[1]","in":"query","required":false,"style":"form","explode":true},{"name":"stateCode","in":"query","required":false,"style":"form","explode":true}]}}}</con:content>
        <con:type>https://swagger.io/openapiv3/specification</con:type>
      </con:part>
    </con:definitionCache>
    <con:endpoints/>
    <con:environmentSpec>
      <con:entry environmentId="1e8db791-2cca-4d3a-9451-5c9a433740b4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
      <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="bookingAddOns" path="/rest/v3/bookingAddOns" id="65eda89c-42a5-4bb4-b9e9-8f8c8b400a24">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_US</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_US</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>celebritycruises.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>celebritycruises.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.brand</con:name>
          <con:value>C</con:value>
          <con:style>QUERY</con:style>
          <con:default>C</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>shipCode</con:name>
          <con:value>ML</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>sailDate</con:name>
          <con:value>2023-01-14</con:value>
          <con:style>QUERY</con:style>
          <con:default>2023-01-14</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>packageId</con:name>
          <con:value>ML07D316</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML07D316</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>currency</con:name>
          <con:value>USD</con:value>
          <con:style>QUERY</con:style>
          <con:default>USD</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>berthCategoryCd</con:name>
          <con:value>12</con:value>
          <con:style>QUERY</con:style>
          <con:default>12</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>cabinNumber</con:name>
          <con:value>2180</con:value>
          <con:style>QUERY</con:style>
          <con:default>2180</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>guestAge</con:name>
          <con:value>28</con:value>
          <con:style>QUERY</con:style>
          <con:default>28</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>pricingPgmCd</con:name>
          <con:value>BESTRATE</con:value>
          <con:style>QUERY</con:style>
          <con:default>BESTRATE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>returnInfo.specialServices</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>returnInfo.diningOptions</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="bookingAddOns" id="3de0eced-fbd1-4bdb-9876-0da0a9b6ad70" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="bookingAddOns_REQ" id="4db884f5-b639-481e-95b7-29c7bb3c9b76" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="Content-Type" value="application/xml" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:request/>
          <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/bookingAddOns</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="createBooking" path="/rest/v3/createBooking" id="1edea70b-6e37-49e8-9a06-92dbd83f3901">
      <con:settings/>
      <con:parameters/>
      <con:method name="createBooking" id="233d37d2-438e-4a8f-a1b9-e1af9fd898b5" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:request name="createBooking_OF_manualData" id="b409c4e8-2bd6-458c-a445-0c60531f6a15" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Content-type" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:request>{
   "header":{
      "application":"royalcaribbean.com",
      "brand":"R",
      "domainId":"1",
      "language":"en_US"
   },
   "countryCode":"USA",
   "sailingInfo":{
      "shipCode":"ML",
      "sailDate":"2023-01-14",
      "packageCode":"ML07D316",
      "currencyCode":"USD"
   },
   "reservations":[
      {
         "cabin":{
            "berthedCategoryCode":"12",
            "fareCode":"I1773897",
            "pricedCategoryCode":"12",
            "waitListed":"false",
            "accessible":"false",
            "number":"2135"
         },
         "dining":[
            {
               "sitting":"O",
               "sittingType":"OPEN",
               "sittingInstance":""
            }
         ],
         "gratuitiesPrepaid":"false",
         "insurance":{
            "code":"CRCR",
            "optionIndicator":"false"
         },
         "fareQualifiers":{
            "seniorReqd":"false",
            "militaryReqd":"false",
            "policeReqd":"false",
            "fireFighterReqd":"false"
         },
         "guestDetails":[
            {
               "guestContact":{
                  "guestRefNumber":"0",
                  "personalInfo":{
                     "name":{
                        "title":"MS",
                        "firstName":"qa one",
                        "lastName":"Tester"
                     },
                     "age":"55",
                     "birthDate":"1960-05-13",
                     "gender":"F",
                     "nationality":"USA"
                  },
                  "address":{
                     "address1":"addr1",
                     "city":"Miramar",
                     "stateCode":"FL",
                     "postalCode":"33029",
                     "countryName":"USA"
                  },
                  "email":"eslqatester@rccl.com"
               }
            },
            {
               "guestContact":{
                  "guestRefNumber":"0",
                  "personalInfo":{
                     "name":{
                        "title":"MR",
                        "firstName":"qa two",
                        "lastName":"tester"
                     },
                     "age":"55",
                     "birthDate":"1960-05-13",
                     "gender":"M",
                     "nationality":"USA"
                  },
                  "address":{
                     "address1":"addr1",
                     "city":"Miramar",
                     "stateCode":"NA",
                     "postalCode":"33029",
                     "countryName":"USA"
                  },
                  "email":"eslqatester@rccl.com"
               }
            }
         ]
         
      }
   ],
   "courtesyHold":"true"
}</con:request>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:request name="createBooking_BK_multiplePayment_fetchData" id="b409c4e8-2bd6-458c-a445-0c60531f6a15" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Content-type" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:request>{
	"header": {
		"application": "${#TestCase#application}",
		"brand": "${#TestCase#brand}",
		"domainId": "1",
		"language": "en_US"
	},
	"countryCode": "${#TestCase#country}",
	"sailingInfo": {
		"shipCode": "${#TestCase#shipCode}",
		"sailDate": "${#TestCase#sailDate}",
		"packageCode": "${#TestCase#packageCode}",
		"currencyCode": "${#TestCase#currency}"
	},
	"reservations": [
		{
			"cabin": {
				"berthedCategoryCode": "${#TestCase#categoryCode}",
				"fareCode": "${#TestCase#fareCode}",
				"pricedCategoryCode": "${#TestCase#categoryCode}",
				"waitListed": "false",
				"accessible": "false",
				"number": "${#TestCase#cabinNumber}"
			},
			"dining": [
				{
					"sitting": "${#TestCase#seatingCd}",
					"sittingType": "OPEN",
					"sittingInstance": "${#TestCase#seatingTime}"
				}
			],
			"gratuitiesPrepaid": "false",
			"insurance": {
				"code": "CRCR",
				"optionIndicator": "false"
			},
			"fareQualifiers": {
				"seniorReqd": "false",
				"militaryReqd": "false",
				"policeReqd": "false",
				"fireFighterReqd": "false"
			},
			"guestDetails": [
				{
					"guestContact": {
						"guestRefNumber": "0",
						"personalInfo": {
							"name": {
								"title": "MR",
								"firstName": "Esl One",
								"lastName": "Tester"
							},
							"age": "31",
							"birthDate": "1991-12-14",
							"gender": "M",
							"nationality": "USA"
						},
						"address": {
							"address1": "addr1",
							"city": "Miramar",
							"stateCode": "FL",
							"postalCode": "33029",
							"countryName": "USA"
						},
						"email": "eslqatester@rccl.com"
					}
				},
				{
					"guestContact": {
						"guestRefNumber": "0",
						"personalInfo": {
							"name": {
								"title": "MR",
								"firstName": "Esl Two",
								"lastName": "Tester"
							},
							"age": "55",
							"birthDate": "1960-05-13",
							"gender": "M",
							"nationality": "USA"
						},
						"address": {
							"address1": "addr1",
							"city": "Miramar",
							"stateCode": "NA",
							"postalCode": "33029",
							"countryName": "USA"
						},
						"email": "eslqatester@rccl.com"
					}
				}
			],
			"listOfCardPayments": {
				"cardPayment": [
					{
						"cardType": "VA",
						"cardToken": "4387751111111111",
						"expireDate": "1230",
						"amount": "100",
						"currency": "USD",
						"extendPayments": "false",
						"contact": {
							"firstName": "Esl One",
							"lastName": "Tester",
							"address": {
								"address1": "ADDRESS",
								"city": "CITY",
								"stateCode": "FLL",
								"postalCode": "33019",
								"countryCode": "USA",
								"countryName": "USA"
							}
						}
					},
					{
						"cardType": "MC",
						"cardToken": "5442981111111114",
						"expireDate": "1230",
						"amount": "100",
						"currency": "USD",
						"extendPayments": "false",
						"contact": {
							"firstName": "Esl Two",
							"lastName": "Tester",
							"address": {
								"address1": "add",
								"city": "city",
								"stateCode": "FL",
								"postalCode": "123",
								"countryCode": "USA",
								"countryName": "USA"
							}
						}
					}
				]
			}
		}
	],
	"courtesyHold": "true"
}</con:request>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:request name="createBooking_BK_multiplePayment_manualData" id="b409c4e8-2bd6-458c-a445-0c60531f6a15" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Content-type" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:request>{
	"header": {
		"application": "royalcaribbean.com",
		"brand": "R",
		"domainId": "1",
		"language": "en_US"
	},
	"countryCode": "USA",
	"sailingInfo": {
		"shipCode": "ML",
		"sailDate": "2023-04-01",
		"packageCode": "ML07D313",
		"currencyCode": "USD"
	},
	"reservations": [
		{
			"cabin": {
				"berthedCategoryCode": "S2",
				"fareCode": "I1771941",
				"pricedCategoryCode": "S2",
				"waitListed": "false",
				"accessible": "false",
				"number": "6120"
			},
			"dining": [
				{
					"sitting": "O",
					"sittingType": "OPEN",
					"sittingInstance": ""
				}
			],
			"gratuitiesPrepaid": "false",
			"insurance": {
				"code": "CRCR",
				"optionIndicator": "false"
			},
			"fareQualifiers": {
				"seniorReqd": "false",
				"militaryReqd": "false",
				"policeReqd": "false",
				"fireFighterReqd": "false"
			},
			"guestDetails": [
				{
					"guestContact": {
						"guestRefNumber": "0",
						"personalInfo": {
							"name": {
								"title": "MR",
								"firstName": "Esl One",
								"lastName": "Tester"
							},
							"age": "31",
							"birthDate": "1991-12-14",
							"gender": "M",
							"nationality": "USA"
						},
						"address": {
							"address1": "addr1",
							"city": "Miramar",
							"stateCode": "FL",
							"postalCode": "33029",
							"countryName": "USA"
						},
						"email": "eslqatester@rccl.com"
					}
				},
				{
					"guestContact": {
						"guestRefNumber": "0",
						"personalInfo": {
							"name": {
								"title": "MR",
								"firstName": "Esl Two",
								"lastName": "Tester"
							},
							"age": "55",
							"birthDate": "1960-05-13",
							"gender": "M",
							"nationality": "USA"
						},
						"address": {
							"address1": "addr1",
							"city": "Miramar",
							"stateCode": "NA",
							"postalCode": "33029",
							"countryName": "USA"
						},
						"email": "eslqatester@rccl.com"
					}
				}
			],
			"listOfCardPayments": {
				"cardPayment": [
					{
						"cardType": "VA",
						"cardToken": "4387751111111111",
						"expireDate": "1230",
						"amount": "100",
						"currency": "USD",
						"extendPayments": "false",
						"contact": {
							"firstName": "Esl One",
							"lastName": "Tester",
							"address": {
								"address1": "ADDRESS",
								"city": "CITY",
								"stateCode": "FLL",
								"postalCode": "33019",
								"countryCode": "USA",
								"countryName": "USA"
							}
						}
					},
					{
						"cardType": "MC",
						"cardToken": "5442981111111114",
						"expireDate": "1230",
						"amount": "100",
						"currency": "USD",
						"extendPayments": "false",
						"contact": {
							"firstName": "Esl Two",
							"lastName": "Tester",
							"address": {
								"address1": "add",
								"city": "city",
								"stateCode": "FL",
								"postalCode": "123",
								"countryCode": "USA",
								"countryName": "USA"
							}
						}
					}
				]
			}
		}
	],
	"courtesyHold": "true"
}</con:request>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="releaseBooking" path="/rest/v3/releaseBooking" id="17867cdd-3e8c-444a-82ad-d924dfabc905">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_US</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_US</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>royalcaribbean.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>royalcaribbean.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.brand</con:name>
          <con:value>R</con:value>
          <con:style>QUERY</con:style>
          <con:default>R</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>bookingId</con:name>
          <con:value>1303231</con:value>
          <con:style>QUERY</con:style>
          <con:default>1303231</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>bookingAccessToken</con:name>
          <con:value>94b163d5-f42c-43e7-b751-eff7d8a1ecfd</con:value>
          <con:style>QUERY</con:style>
          <con:default>94b163d5-f42c-43e7-b751-eff7d8a1ecfd</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>lockBooking</con:name>
          <con:value>true</con:value>
          <con:style>QUERY</con:style>
          <con:default>true</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="releaseBooking" id="0d9df9d4-38b7-4483-80ae-0ec9da1582d1" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="releaseBooking_REQ" id="e0135d9d-6b24-4332-996d-3f8c56b32255" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Accept" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:request/>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="header.application" value="${#TestCase#application}"/>
            <con:entry key="countryCode" value="${#TestCase#country}"/>
            <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
            <con:entry key="header.brand" value="${#TestCase#brand}"/>
            <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
          </con:parameters>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="retrieveBooking" path="/rest/v3/retrieveBooking" id="dd40ce48-619e-4d32-8be0-11f9c1aa8135">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_US</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_US</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>royalcaribbean.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>royalcaribbean.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.brand</con:name>
          <con:value>R</con:value>
          <con:style>QUERY</con:style>
          <con:default>R</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>shipCode</con:name>
          <con:value>SM</con:value>
          <con:style>QUERY</con:style>
          <con:default>SM</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>sailDate</con:name>
          <con:value>2023-01-09</con:value>
          <con:style>QUERY</con:style>
          <con:default>2023-01-09</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>bookingId</con:name>
          <con:value>1303231</con:value>
          <con:style>QUERY</con:style>
          <con:default>1303231</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>lastName</con:name>
          <con:value>Gamit</con:value>
          <con:style>QUERY</con:style>
          <con:default>Gamit</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>lockBooking</con:name>
          <con:value>TRUE</con:value>
          <con:style>QUERY</con:style>
          <con:default>TRUE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>summaryRequested</con:name>
          <con:value>FALSE</con:value>
          <con:style>QUERY</con:style>
          <con:default>FALSE</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="retrieveBooking" id="0cf5c78e-947e-4005-af26-118d4ac54d0c" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="retrieveBooking_REQ" id="5d1548a4-8bdb-4e8d-b961-ec1d7235ef93" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Accept" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
          </con:settings>
          <con:request/>
          <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveBooking</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="retrievePaymentHistory" path="/rest/v3/retrievePaymentHistory" id="5ff3ef7f-8711-476e-9686-8d8f652d2f7b">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>royalcaribbean.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>royalcaribbean.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.brand</con:name>
          <con:value>R</con:value>
          <con:style>QUERY</con:style>
          <con:default>R</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_US</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_US</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>agencyId</con:name>
          <con:style>QUERY</con:style>
        </con:parameter>
        <con:parameter required="true">
          <con:name>bookingId</con:name>
          <con:value>1272258</con:value>
          <con:style>QUERY</con:style>
          <con:default>1272258</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>bookingAccessToken</con:name>
          <con:value>ca2e48fb-b5b9-4f1a-a86a-6c508ead995f</con:value>
          <con:style>QUERY</con:style>
          <con:default>ca2e48fb-b5b9-4f1a-a86a-6c508ead995f</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>shipCode</con:name>
          <con:value>AN</con:value>
          <con:style>QUERY</con:style>
          <con:default>AN</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>sailDate</con:name>
          <con:value>2023-02-26</con:value>
          <con:style>QUERY</con:style>
          <con:default>2023-02-26</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="retrievePaymentHistory" id="e1aef5c8-e7b1-4164-8858-26a7fc2ab247" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="retrievePaymentHistory_REQ1" id="6d030ab9-443b-40f4-9569-df98b15dd373" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:request/>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="bookingAccessToken" value=""/>
            <con:entry key="sailDate" value=""/>
            <con:entry key="bookingId" value=""/>
            <con:entry key="shipCode" value=""/>
          </con:parameters>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="retrieveStateroomOffers" path="/rest/v3/retrieveStateroomOffers" id="afa80eff-9e38-414e-992c-80d769a45075">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_US</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_US</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>celebritycruises.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>celebritycruises.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.brand</con:name>
          <con:value>C</con:value>
          <con:style>QUERY</con:style>
          <con:default>C</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>shipCode</con:name>
          <con:value>ML</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>sailDate</con:name>
          <con:value>2023-01-14</con:value>
          <con:style>QUERY</con:style>
          <con:default>2023-01-14</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>packageId</con:name>
          <con:value>ML07D316</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML07D316</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>currency</con:name>
          <con:value>USD</con:value>
          <con:style>QUERY</con:style>
          <con:default>USD</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>guestAge</con:name>
          <con:value>25</con:value>
          <con:style>QUERY</con:style>
          <con:default>25</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>accessibleReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>seniorReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>militaryReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>policeReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>fireFighterReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter>
          <con:name>stateCode</con:name>
          <con:style>QUERY</con:style>
        </con:parameter>
        <con:parameter>
          <con:name>loyaltyId</con:name>
          <con:style>QUERY</con:style>
        </con:parameter>
        <con:parameter>
          <con:name>couponCode</con:name>
          <con:style>QUERY</con:style>
        </con:parameter>
        <con:parameter required="true">
          <con:name>includeNonRefundablePromos</con:name>
          <con:value>TRUE</con:value>
          <con:style>QUERY</con:style>
          <con:default>TRUE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>includePromoBreakdown</con:name>
          <con:value>TRUE</con:value>
          <con:style>QUERY</con:style>
          <con:default>TRUE</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="retrieveStateroomOffers" id="1f4ab7e5-8448-4cbd-9cdf-774393e02e7e" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="retrieveStateroomOffers_REQ1" id="c0911431-1d0b-463a-9026-f8c123679434" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:request/>
          <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveStateroomOffers</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="retrieveStateroomsForCategory" path="/rest/v3/retrieveStateroomsForCategory" id="61e2360e-cece-4d65-9cbe-6c0735213ed1">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>header.domainId</con:name>
          <con:value>1</con:value>
          <con:style>QUERY</con:style>
          <con:default>1</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.language</con:name>
          <con:value>en_US</con:value>
          <con:style>QUERY</con:style>
          <con:default>en_US</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.application</con:name>
          <con:value>celebritycruises.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>celebritycruises.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>header.brand</con:name>
          <con:value>C</con:value>
          <con:style>QUERY</con:style>
          <con:default>C</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>shipCode</con:name>
          <con:value>ML</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>sailDate</con:name>
          <con:value>2023-01-14</con:value>
          <con:style>QUERY</con:style>
          <con:default>2023-01-14</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>packageId</con:name>
          <con:value>ML07D316</con:value>
          <con:style>QUERY</con:style>
          <con:default>ML07D316</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>currency</con:name>
          <con:value>USD</con:value>
          <con:style>QUERY</con:style>
          <con:default>USD</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>categoryCode</con:name>
          <con:value>12</con:value>
          <con:style>QUERY</con:style>
          <con:default>12</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>stateroomOccupancy.guestAge</con:name>
          <con:value>24</con:value>
          <con:style>QUERY</con:style>
          <con:default>24</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>stateroomOccupancy.fareCode</con:name>
          <con:value>BESTRATE</con:value>
          <con:style>QUERY</con:style>
          <con:default>BESTRATE</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>stateroomOccupancy.seniorReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>stateroomOccupancy.accessibleReqd</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="retrieveStateroomsForCategory" id="48f06148-7e2a-4f0c-ad5c-c2eef6099afd" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="retrieveStateroomsForCategory_REQ1" id="a6f4c418-fd37-4e49-b7f4-b3a64ae59903" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:request/>
          <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveStateroomsForCategory</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:environmentSpec>
            <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
    <con:resource name="bbb" path="/en/c/web/v1/esl/promotions/bbb" id="f3d75d36-1f55-4279-a409-4da7832e64d7">
      <con:settings/>
      <con:parameters>
        <con:parameter required="true">
          <con:name>domain</con:name>
          <con:value>celebritycruises.com</con:value>
          <con:style>QUERY</con:style>
          <con:default>celebritycruises.com</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>currency</con:name>
          <con:value>USD</con:value>
          <con:style>QUERY</con:style>
          <con:default>USD</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>countryCode</con:name>
          <con:value>USA</con:value>
          <con:style>QUERY</con:style>
          <con:default>USA</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>includeNonRefundablePromos</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>packageId</con:name>
          <con:value>EC12K154</con:value>
          <con:style>QUERY</con:style>
          <con:default>EC12K154</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>sailDate</con:name>
          <con:value>20230126</con:value>
          <con:style>QUERY</con:style>
          <con:default>20230126</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>shipCode</con:name>
          <con:value>EC</con:value>
          <con:style>QUERY</con:style>
          <con:default>EC</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>categoryCode</con:name>
          <con:value>A2</con:value>
          <con:style>QUERY</con:style>
          <con:default>A2</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>etl</con:name>
          <con:value>false</con:value>
          <con:style>QUERY</con:style>
          <con:default>false</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>guestAge[0]</con:name>
          <con:value>25</con:value>
          <con:style>QUERY</con:style>
          <con:default>25</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>guestAge[1]</con:name>
          <con:value>25</con:value>
          <con:style>QUERY</con:style>
          <con:default>25</con:default>
        </con:parameter>
        <con:parameter required="true">
          <con:name>stateCode</con:name>
          <con:value>FL</con:value>
          <con:style>QUERY</con:style>
          <con:default>FL</con:default>
        </con:parameter>
      </con:parameters>
      <con:method name="Method 1" id="63f6f91d-2dfc-49aa-9f75-35810dd03c82" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="Request 1" id="b69a70dd-9155-40ed-aa35-7bae108fad41" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:request/>
          <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/en/c/web/v1/esl/promotions/bbb</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:testSuite id="4cb22652-7f3c-4064-8693-2e7ad2f2f1b7" name="Booking Creation without Data Source">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="ac8eff56-8699-4a76-90c1-84f2b78a7616" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Courtesy Hold - No Qualifiers" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="restrequest" name="cruiseSearch" id="4682bf8f-3868-4b27-98bc-537dc088ab85">
        <con:settings/>
        <con:config service="Cruise Search" methodName="cruiseSearch" resourcePath="/esl/search/rest/cruiseSearch" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="cruiseSearch" id="4b83a4b3-3cb3-4dac-ab4a-9f8353f23135" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>http://eslaservicestst01.rccl.com/esl/search/rest/cruiseSearch</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="aeea0b73-a636-43f8-9e7e-592c253cb5c6" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="970f9f2a-b98c-4157-a7d0-bdb110cadbb3" name="Script Assertion">
              <con:configuration>
                <scriptText>def xmlRes = messageExchange.getResponse().contentAsString
def xmlSlurper = new groovy.xml.XmlSlurper();
def parse = xmlSlurper.parseText(xmlRes)
log.info parse


def totalHits = (parse.resultsSummary.totalHits.text()).toInteger()
log.info totalHits
assert totalHits!=0</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="qualifiers.qualifierScope" value="SEARCH_AND_PRICE"/>
              <con:entry key="header.language" value="en_us"/>
              <con:entry key="resultsPreference.includeOnlyIfPriceAvailable" value="true"/>
              <con:entry key="criteria.channel" value="VP"/>
              <con:entry key="qualifiers.offersType.strictPricingFlag" value="true"/>
              <con:entry key="qualifiers.priceScope" value="REQUESTED_AVAILABLE"/>
              <con:entry key="resultsPreference.includeResults" value="true"/>
              <con:entry key="criteria.currency" value="USD"/>
              <con:entry key="resultsPreference.strictSearch" value="true"/>
              <con:entry key="criteria.ship.value" value="SM"/>
              <con:entry key="resultsPreference.priceLevel.bestPricedCategory" value="true"/>
              <con:entry key="resultsPreference.sortOrder" value="DESCENDING"/>
              <con:entry key="resultsPreference.includePrices" value="true"/>
              <con:entry key="resultsPreference.groupBy" value="PACKAGE"/>
              <con:entry key="criteria.bookingType" value="FIT"/>
              <con:entry key="resultsPreference.pagination.count" value="100"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="criteria.occupancy.adult" value="2"/>
              <con:entry key="resultsPreference.sortBy" value="DURATION"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_REQ_app/country/currency" id="09fe429d-3dfa-4974-9366-e3fec73d407f">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import org.apache.commons.lang3.StringUtils;


def ts = testRunner.testCase.getTestStepByName("cruiseSearch");
String  url =  ts.getHttpRequest().getResponse().getURL(); 
log.info(url)

String app = StringUtils.substringBetween(url, "header.application=", "&amp;");
log.info(app)
testRunner.testCase.setPropertyValue("application",app);


String country = StringUtils.substringBetween(url, "criteria.country=", "&amp;");
log.info(country)
testRunner.testCase.setPropertyValue("country",country);


String currency = StringUtils.substringBetween(url, "criteria.currency=", "&amp;");
log.info(currency)
testRunner.testCase.setPropertyValue("currency",currency);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_brand/ship/saildate/package" id="a813873d-3ca5-4048-ba76-89a3e8b62953">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;


def ts = testRunner.testCase.getTestStepByName("cruiseSearch");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Package Code
def packageCode = res.resultsByPackage.packageSummaryWithClassLevelPricing[0].packageReference.@code.text()
log.info(packageCode)
testRunner.testCase.setPropertyValue("packageCode",packageCode);


//Set Test Case Ship Code
def  shipCode= packageCode.substring(0,2);
log.info(shipCode)
testRunner.testCase.setPropertyValue("shipCode",shipCode);

//Set Test Case Sail Date
def sailDate = res.resultsByPackage.packageSummaryWithClassLevelPricing[0].cabinClassPriceBySailing[0].sailingRef.@saildate.text()
log.info(sailDate)
testRunner.testCase.setPropertyValue("sailDate",sailDate);

//Set Test Case Brand
def celebrityBrand = "C"
def royalBrand = "R"

def celebrityShips = ['AX', 'AT', 'BY', 'CS', 'EC', 'EG', 'EQ', 'FL', 'IN', 'ML', 'RF', 'SI', 'SL', 'SM', 'XP', 'XO']
def royalShips = ['AD', 'AL', 'AN', 'BR', 'NE', 'EN', 'EX', 'FR', 'GR', 'HM', 'IC', 'ID', 'JW', 'LB', 'MJ', 'MA', 'NV', 'NC', 'OA', 'OY', 'OV', 'QN', 'RD', 'RH', 'SR', 'SC', 'SY', 'WC', 'UT', 'VI', 'VY', 'WN']


if (celebrityShips.contains(shipCode)) {	
	testRunner.testCase.setPropertyValue("brand",celebrityBrand);
	} else {
		testRunner.testCase.setPropertyValue("brand",royalBrand);
		}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrieveStateroomOffers" id="1cf6442f-4845-47f4-92bb-c77ff915a22c">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/retrieveStateroomOffers" methodName="retrieveStateroomOffers" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveStateroomOffers" id="c0911431-1d0b-463a-9026-f8c123679434" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveStateroomOffers</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="70e5e336-8054-4468-9dcf-416401cb151b" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="4ceadddf-0c8a-46cf-826f-fd37cf6b3955" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="packageId" value="${#TestCase#packageCode}"/>
              <con:entry key="currency" value="${#TestCase#currency}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_categoryCode/fareCode" id="f0c522a4-7694-498b-8f4a-1442db3efb31">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;



def ts = testRunner.testCase.getTestStepByName("retrieveStateroomOffers");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Fare Code
def fareCode = res.stateroomOffers.e[0].stateroomOffers.e[0].selectedFareCode.text()
log.info(fareCode)
testRunner.testCase.setPropertyValue("fareCode",fareCode);

//Set Test Case Category Code
def categoryCode = res.stateroomOffers.e[0].stateroomOffers.e[0].categoryCode.text()
log.info(categoryCode)
testRunner.testCase.setPropertyValue("categoryCode",categoryCode);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrieveStateroomsForCategory" id="1ceffe4f-3404-4d89-a3ba-af1e1a2b9351">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveStateroomsForCategory" resourcePath="/rest/v3/retrieveStateroomsForCategory" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveStateroomsForCategory" id="0b4bcbf3-a807-4e6f-b760-0776798d5c9b" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveStateroomsForCategory</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="b6a4a681-5221-448d-8703-953dfdcb461a" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="dbc38ae4-a840-4616-9e36-a3c819efa593" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="stateroomOccupancy.guestAge" value="25"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="packageId" value="${#TestCase#packageCode}"/>
              <con:entry key="stateroomOccupancy.seniorReqd" value="false"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="currency" value="${#TestCase#currency}"/>
              <con:entry key="categoryCode" value="${#TestCase#categoryCode}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_cabinNumber" id="2ad08b77-195b-4de4-b4d4-d9799264e155">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;



def ts = testRunner.testCase.getTestStepByName("retrieveStateroomsForCategory");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Cabin Number
def cabinNumber = res.cabin.e[0].cabinNumber.text()
log.info(cabinNumber)
testRunner.testCase.setPropertyValue("cabinNumber",cabinNumber);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="bookingAddOns" id="fb76408f-0d05-4cf3-8da8-134877728b6e">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/bookingAddOns" methodName="bookingAddOns" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="bookingAddOns" id="4db884f5-b639-481e-95b7-29c7bb3c9b76" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/bookingAddOns</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="4b86411f-ceac-45ad-ab98-d73d2c4aa027" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="cab0ebc3-7394-46b3-87aa-8b0c098e7528" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="guestAge" value="25"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="returnInfo.specialServices" value="false"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="packageId" value="${#TestCase#packageCode}"/>
              <con:entry key="currency" value="${#TestCase#currency}"/>
              <con:entry key="berthCategoryCd" value="${#TestCase#categoryCode}"/>
              <con:entry key="cabinNumber" value="${#TestCase#cabinNumber}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_dining" id="f9bbe700-cff6-4fc1-9aef-7f86645ad020">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;



def ts = testRunner.testCase.getTestStepByName("bookingAddOns");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Seating Code
def seatingCd  = res.diningOptions.openDining.dining.e[0].seatingCd.text()
log.info(seatingCd)
testRunner.testCase.setPropertyValue("seatingCd",seatingCd);


//Set Test Case Seating Time
def seatingTime  = res.diningOptions.openDining.dining.e[0].seatingTime.text()
log.info(seatingTime)
testRunner.testCase.setPropertyValue("seatingTime",seatingTime);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="createBooking" id="347f4411-8296-4868-aee5-0b9fa1fe1d43">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/createBooking" methodName="createBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="createBooking" id="b409c4e8-2bd6-458c-a445-0c60531f6a15" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Content-type" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:request>{
  "header": {
    "application": "${#TestCase#application}",
    "brand": "${#TestCase#brand}",
    "domainId": "1",
    "language": "en_US"
  },
  "countryCode": "${#TestCase#country}",
  "sailingInfo": {
    "shipCode": "${#TestCase#shipCode}",
    "sailDate": "${#TestCase#sailDate}",
    "packageCode": "${#TestCase#packageCode}",
    "currencyCode": "${#TestCase#currency}"
  },
  "reservations": [
    {
      "cabin": {
        "berthedCategoryCode": "${#TestCase#categoryCode}",
        "fareCode": "${#TestCase#fareCode}",
        "pricedCategoryCode": "${#TestCase#categoryCode}",
        "waitListed": "false",
        "accessible": "false",
        "number": "${#TestCase#cabinNumber}"
      },
      "dining": [
        {
          "sitting": "${#TestCase#seatingCd}",
          "sittingType": "OPEN",
          "sittingInstance": "${#TestCase#seatingTime}"
        }
      ],
      "gratuitiesPrepaid": "false",
      "insurance": {
        "code": "CRCR",
        "optionIndicator": "false"
      },
      "fareQualifiers": {
        "seniorReqd": "false",
        "militaryReqd": "false",
        "policeReqd": "false",
        "fireFighterReqd": "false"
      },
      "guestDetails": [
        {
          "guestContact": {
            "guestRefNumber": "0",
            "personalInfo": {
              "name": {
                "title": "MS",
                "firstName": "ESL One",
                "lastName": "Tester"
              },
              "age": "55",
              "birthDate": "1960-05-13",
              "gender": "F",
              "nationality": "USA"
            },
            "address": {
              "address1": "addr1",
              "city": "Miramar",
              "stateCode": "FL",
              "postalCode": "33029",
              "countryName": "USA"
            },
            "email": "eslqa@rccl.com"
          }
        },
        {
          "guestContact": {
            "guestRefNumber": "0",
            "personalInfo": {
              "name": {
                "title": "MR",
                "firstName": "ESL Two",
                "lastName": "Tester"
              },
              "age": "55",
              "birthDate": "1960-05-13",
              "gender": "M",
              "nationality": "USA"
            },
            "address": {
              "address1": "addr1",
              "city": "Miramar",
              "stateCode": "NA",
              "postalCode": "33029",
              "countryName": "USA"
            },
            "email": "eslqa@rccl.com"
          }
        }
      ]
    }
  ],
  "courtesyHold": "true"
}</con:request>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/createBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="2246d26e-df78-4848-99de-da9397acacc5" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0d3b6e1f-409b-4e9f-817c-e7d957524669" name="Validate Booking ID not null">
              <con:configuration>
                <scriptText>def jsonRes = messageExchange.getResponse().contentAsString


def jsonSlurper = new groovy.json.JsonSlurper();
def parse = jsonSlurper.parseText(jsonRes)


def bookingId = parse.bookingConfirmation.bookingId
log.info bookingId
assert bookingId!=null</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_lastname/booking" id="393b723a-d2e0-4fb9-91e1-58d4c77f5696">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import groovy.json.*
import groovy.util.*


def ts = testRunner.testCase.getTestStepByName("createBooking");

def xml = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));
log.info(xml)

def json = new JsonSlurper().parseText(ts.getPropertyValue("RawRequest"));
log.info(json)


//Set Test Case Booking ID
def booking  = xml.bookingConfirmation.bookingId.text()
log.info(booking)
testRunner.testCase.setPropertyValue("bookingId",booking);


//Set Test Case lastName
def lastname = json.reservations[0].guestDetails[0].guestContact.personalInfo.name.lastName
log.info(lastname)
testRunner.testCase.setPropertyValue("lastname",lastname);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="delay" name="Delay" id="97e514ff-c301-4c79-8dec-e24d23cab96b">
        <con:settings/>
        <con:config>
          <delay>2000</delay>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrieveBooking" id="7bdab11c-cc7a-404c-83b5-900edab16f08">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveBooking" resourcePath="/rest/v3/retrieveBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveBooking" id="5233383c-3985-4305-ab02-2225af0d0e20" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="aa751c95-8f3c-46fc-b1a0-39d195e9727d" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" name="Contains" id="836cc23a-febd-410e-a3d5-c136bb4303e9">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="8d2c2110-d9ab-4d1b-9a6e-cbe94da21f3a" name="Validate accessToken is not null">
              <con:configuration>
                <scriptText>def jsonRes = messageExchange.getResponse().contentAsString


def jsonSlurper = new groovy.json.JsonSlurper();
def parse = jsonSlurper.parseText(jsonRes)


def token = parse.bookingAccessToken
log.info token
assert token!=null</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="lastName" value="${#TestCase#lastname}"/>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="summaryRequested" value="FALSE"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_bookingAccessToken" id="1786cc89-ccba-4514-9c92-eeaef544d9fd">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import groovy.json.*
import groovy.util.*


def ts = testRunner.testCase.getTestStepByName("retrieveBooking");

def xml = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));
log.info(xml)


//Set Test Case bookingAccessToken
def bookingAccessToken  = xml.bookingAccessToken.text()
log.info(bookingAccessToken)
testRunner.testCase.setPropertyValue("bookingAccessToken",bookingAccessToken);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="releaseBooking" id="33d9fa8b-432e-435b-87d9-359dcc049b34">
        <con:settings/>
        <con:config service="Booking" methodName="releaseBooking" resourcePath="/rest/v3/releaseBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="releaseBooking" id="de6517cc-b30f-416b-9427-21d29356bb6d" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/releaseBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="be37509b-9000-4ee0-a8b1-67535b72db92" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="ed9d1312-71d3-4bf7-b5be-f34affb3d475" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>PackageCode</con:name>
          <con:value>SM05W354</con:value>
        </con:property>
        <con:property>
          <con:name>TestShip</con:name>
          <con:value>AX</con:value>
        </con:property>
        <con:property>
          <con:name>shipCode</con:name>
          <con:value>SM</con:value>
        </con:property>
        <con:property>
          <con:name>sailDate</con:name>
          <con:value>2023-01-09</con:value>
        </con:property>
        <con:property>
          <con:name>brand</con:name>
          <con:value>C</con:value>
        </con:property>
        <con:property>
          <con:name>fareCode</con:name>
          <con:value>I1773897</con:value>
        </con:property>
        <con:property>
          <con:name>categoryCode</con:name>
          <con:value>11</con:value>
        </con:property>
        <con:property>
          <con:name>cabinNumber</con:name>
          <con:value>2140</con:value>
        </con:property>
        <con:property>
          <con:name>seatingCd</con:name>
          <con:value>O</con:value>
        </con:property>
        <con:property>
          <con:name>seatingTime</con:name>
          <con:value>CEL SLCT</con:value>
        </con:property>
        <con:property>
          <con:name>application</con:name>
          <con:value>celebritycruises.com</con:value>
        </con:property>
        <con:property>
          <con:name>country</con:name>
          <con:value>USA</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value>USD</con:value>
        </con:property>
        <con:property>
          <con:name>bookingID</con:name>
          <con:value>1312240</con:value>
        </con:property>
        <con:property>
          <con:name>lastname</con:name>
          <con:value>Tester</con:value>
        </con:property>
        <con:property>
          <con:name>bookingAccessToken</con:name>
          <con:value>c9a4543a-58db-4474-8b54-5eff2e5a4bcf</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="827ee869-4b44-4b25-ad71-536a6002a842" name="Booking Creation using Data Source">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="42b7cff2-0a8c-4fc8-908c-52d9a273969a" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Courtesy Hold - No Qualifiers" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="datasource" name="DataSource" id="be28898c-1ad6-4562-9be0-008d811fab6e">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>C:/Users/126953/OneDrive - Royal Caribbean Group/Desktop/Work/ESL/ReadyAPI Collection/ESL QA/Booking_REST_Input.xlsx</file>
              <worksheet/>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Type</con:property>
          <con:property>Test #</con:property>
          <con:property>criteria.channel</con:property>
          <con:property>criteria.bookingType</con:property>
          <con:property>header.domainId</con:property>
          <con:property>header.language</con:property>
          <con:property>header.application</con:property>
          <con:property>criteria.brand.value</con:property>
          <con:property>criteria.ship.value</con:property>
          <con:property>criteria.cruiseType.value</con:property>
          <con:property>criteria.office</con:property>
          <con:property>criteria.country</con:property>
          <con:property>criteria.currency</con:property>
          <con:property>criteria.occupancy.adult</con:property>
          <con:restartOnRun>true</con:restartOnRun>
          <con:stopDatasourceExhausted>false</con:stopDatasourceExhausted>
        </con:config>
      </con:testStep>
      <con:testStep type="delay" name="Delay 2" id="32fe2c75-faa0-4cbc-896a-efb000e246b5">
        <con:settings/>
        <con:config>
          <delay>2000</delay>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="cruiseSearch" id="7e571a73-6140-4533-bf1e-74efdfbd8861">
        <con:settings/>
        <con:config service="Cruise Search" methodName="cruiseSearch" resourcePath="/esl/search/rest/cruiseSearch" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="cruiseSearch" id="4b83a4b3-3cb3-4dac-ab4a-9f8353f23135" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>http://eslaservicestst01.rccl.com/esl/search/rest/cruiseSearch</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="aeea0b73-a636-43f8-9e7e-592c253cb5c6" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="970f9f2a-b98c-4157-a7d0-bdb110cadbb3" name="Script Assertion">
              <con:configuration>
                <scriptText>def xmlRes = messageExchange.getResponse().contentAsString
def xmlSlurper = new groovy.xml.XmlSlurper();
def parse = xmlSlurper.parseText(xmlRes)
log.info parse


def totalHits = (parse.resultsSummary.totalHits.text()).toInteger()
log.info totalHits
assert totalHits!=0</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="qualifiers.qualifierScope" value="SEARCH_AND_PRICE"/>
              <con:entry key="header.language" value="${DataSource#header.language}"/>
              <con:entry key="criteria.brand.value" value="${DataSource#criteria.brand.value}"/>
              <con:entry key="header.application" value="${DataSource#header.application}"/>
              <con:entry key="resultsPreference.includeOnlyIfPriceAvailable" value="true"/>
              <con:entry key="criteria.channel" value="${DataSource#criteria.channel}"/>
              <con:entry key="qualifiers.offersType.strictPricingFlag" value="true"/>
              <con:entry key="qualifiers.priceScope" value="REQUESTED_AVAILABLE"/>
              <con:entry key="resultsPreference.includeResults" value="true"/>
              <con:entry key="criteria.currency" value="${DataSource#criteria.currency}"/>
              <con:entry key="criteria.office" value="${DataSource#criteria.office}"/>
              <con:entry key="resultsPreference.strictSearch" value="true"/>
              <con:entry key="criteria.ship.value" value="${DataSource#criteria.ship.value}"/>
              <con:entry key="resultsPreference.priceLevel.bestPricedCategory" value="true"/>
              <con:entry key="resultsPreference.sortOrder" value="DESCENDING"/>
              <con:entry key="resultsPreference.includePrices" value="true"/>
              <con:entry key="resultsPreference.groupBy" value="PACKAGE"/>
              <con:entry key="criteria.bookingType" value="${DataSource#criteria.bookingType}"/>
              <con:entry key="resultsPreference.pagination.count" value="100"/>
              <con:entry key="header.domainId" value="${DataSource#header.domainId}"/>
              <con:entry key="criteria.country" value="${DataSource#criteria.country}"/>
              <con:entry key="criteria.occupancy.adult" value="${DataSource#criteria.occupancy.adult}"/>
              <con:entry key="resultsPreference.sortBy" value="DURATION"/>
              <con:entry key="criteria.cruiseType.value" value="${DataSource#criteria.cruiseType.value}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_REQ_app/country/currency" id="f48221aa-23a2-451e-bd4a-ff3cccce139a">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import org.apache.commons.lang3.StringUtils;


def ts = testRunner.testCase.getTestStepByName("cruiseSearch");
String  url =  ts.getHttpRequest().getResponse().getURL(); 
log.info(url)

String app = StringUtils.substringBetween(url, "header.application=", "&amp;");
log.info(app)
testRunner.testCase.setPropertyValue("application",app);


String country = StringUtils.substringBetween(url, "criteria.country=", "&amp;");
log.info(country)
testRunner.testCase.setPropertyValue("country",country);


String currency = StringUtils.substringBetween(url, "criteria.currency=", "&amp;");
log.info(currency)
testRunner.testCase.setPropertyValue("currency",currency);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_brand/ship/saildate/package" id="2567deae-382d-4832-b0f3-1630ac49732b">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;


def ts = testRunner.testCase.getTestStepByName("cruiseSearch");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Package Code
def packageCode = res.resultsByPackage.packageSummaryWithClassLevelPricing[0].packageReference.@code.text()
log.info(packageCode)
testRunner.testCase.setPropertyValue("packageCode",packageCode);


//Set Test Case Ship Code
def  shipCode= packageCode.substring(0,2);
log.info(shipCode)
testRunner.testCase.setPropertyValue("shipCode",shipCode);

//Set Test Case Sail Date
def sailDate = res.resultsByPackage.packageSummaryWithClassLevelPricing[0].cabinClassPriceBySailing[0].sailingRef.@saildate.text()
log.info(sailDate)
testRunner.testCase.setPropertyValue("sailDate",sailDate);

//Set Test Case Brand
def celebrityBrand = "C"
def royalBrand = "R"

def celebrityShips = ['AX', 'AT', 'BY', 'CS', 'EC', 'EG', 'EQ', 'FL', 'IN', 'ML', 'RF', 'SI', 'SL', 'SM', 'XP', 'XO']
def royalShips = ['AD', 'AL', 'AN', 'BR', 'NE', 'EN', 'EX', 'FR', 'GR', 'HM', 'IC', 'ID', 'JW', 'LB', 'MJ', 'MA', 'NV', 'NC', 'OA', 'OY', 'OV', 'QN', 'RD', 'RH', 'SR', 'SC', 'SY', 'WC', 'UT', 'VI', 'VY', 'WN']


if (celebrityShips.contains(shipCode)) {	
	testRunner.testCase.setPropertyValue("brand",celebrityBrand);
	} else {
		testRunner.testCase.setPropertyValue("brand",royalBrand);
		}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrieveStateroomOffers" id="b87fe9f4-c46b-437c-b650-788acfbe1566">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/retrieveStateroomOffers" methodName="retrieveStateroomOffers" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveStateroomOffers" id="c0911431-1d0b-463a-9026-f8c123679434" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveStateroomOffers</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="70e5e336-8054-4468-9dcf-416401cb151b" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="4ceadddf-0c8a-46cf-826f-fd37cf6b3955" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="packageId" value="${#TestCase#packageCode}"/>
              <con:entry key="currency" value="${#TestCase#currency}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_categoryCode/fareCode" id="63992328-4fce-4304-b50c-cff0fb3e43b5">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;



def ts = testRunner.testCase.getTestStepByName("retrieveStateroomOffers");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Fare Code
def fareCode = res.stateroomOffers.e[0].stateroomOffers.e[0].selectedFareCode.text()
log.info(fareCode)
testRunner.testCase.setPropertyValue("fareCode",fareCode);

//Set Test Case Category Code
def categoryCode = res.stateroomOffers.e[0].stateroomOffers.e[0].categoryCode.text()
log.info(categoryCode)
testRunner.testCase.setPropertyValue("categoryCode",categoryCode);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrieveStateroomsForCategory" id="bcd42710-b6e0-4fb0-9444-337c75ed23ee">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveStateroomsForCategory" resourcePath="/rest/v3/retrieveStateroomsForCategory" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveStateroomsForCategory" id="0b4bcbf3-a807-4e6f-b760-0776798d5c9b" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveStateroomsForCategory</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="b6a4a681-5221-448d-8703-953dfdcb461a" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="dbc38ae4-a840-4616-9e36-a3c819efa593" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="stateroomOccupancy.guestAge" value="25"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="packageId" value="${#TestCase#packageCode}"/>
              <con:entry key="stateroomOccupancy.seniorReqd" value="false"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="currency" value="${#TestCase#currency}"/>
              <con:entry key="categoryCode" value="${#TestCase#categoryCode}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_cabinNumber" id="884d0103-04b5-4e9e-9697-b073b8fe234c">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;



def ts = testRunner.testCase.getTestStepByName("retrieveStateroomsForCategory");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Cabin Number
def cabinNumber = res.cabin.e[0].cabinNumber.text()
log.info(cabinNumber)
testRunner.testCase.setPropertyValue("cabinNumber",cabinNumber);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="bookingAddOns" id="5d7561f1-9298-4aab-b352-7a3bd838d0a6">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/bookingAddOns" methodName="bookingAddOns" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="bookingAddOns" id="4db884f5-b639-481e-95b7-29c7bb3c9b76" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/bookingAddOns</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="4b86411f-ceac-45ad-ab98-d73d2c4aa027" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="cab0ebc3-7394-46b3-87aa-8b0c098e7528" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="guestAge" value="25"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="returnInfo.specialServices" value="false"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="packageId" value="${#TestCase#packageCode}"/>
              <con:entry key="currency" value="${#TestCase#currency}"/>
              <con:entry key="berthCategoryCd" value="${#TestCase#categoryCode}"/>
              <con:entry key="cabinNumber" value="${#TestCase#cabinNumber}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_dining" id="fab60cfd-9eef-4357-9395-408970e20fcf">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;



def ts = testRunner.testCase.getTestStepByName("bookingAddOns");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Seating Code
def seatingCd  = res.diningOptions.openDining.dining.e[0].seatingCd.text()
log.info(seatingCd)
testRunner.testCase.setPropertyValue("seatingCd",seatingCd);


//Set Test Case Seating Time
def seatingTime  = res.diningOptions.openDining.dining.e[0].seatingTime.text()
log.info(seatingTime)
testRunner.testCase.setPropertyValue("seatingTime",seatingTime);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="createBooking" id="15636a03-8ce2-44c4-a00f-56f7e0a709ed">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/createBooking" methodName="createBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="createBooking" id="b409c4e8-2bd6-458c-a445-0c60531f6a15" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Content-type" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:request>{
  "header": {
    "application": "${#TestCase#application}",
    "brand": "${#TestCase#brand}",
    "domainId": "1",
    "language": "en_US"
  },
  "countryCode": "${#TestCase#country}",
  "sailingInfo": {
    "shipCode": "${#TestCase#shipCode}",
    "sailDate": "${#TestCase#sailDate}",
    "packageCode": "${#TestCase#packageCode}",
    "currencyCode": "${#TestCase#currency}"
  },
  "reservations": [
    {
      "cabin": {
        "berthedCategoryCode": "${#TestCase#categoryCode}",
        "fareCode": "${#TestCase#fareCode}",
        "pricedCategoryCode": "${#TestCase#categoryCode}",
        "waitListed": "false",
        "accessible": "false",
        "number": "${#TestCase#cabinNumber}"
      },
      "dining": [
        {
          "sitting": "${#TestCase#seatingCd}",
          "sittingType": "OPEN",
          "sittingInstance": "${#TestCase#seatingTime}"
        }
      ],
      "gratuitiesPrepaid": "false",
      "insurance": {
        "code": "CRCR",
        "optionIndicator": "false"
      },
      "fareQualifiers": {
        "seniorReqd": "false",
        "militaryReqd": "false",
        "policeReqd": "false",
        "fireFighterReqd": "false"
      },
      "guestDetails": [
        {
          "guestContact": {
            "guestRefNumber": "0",
            "personalInfo": {
              "name": {
                "title": "MS",
                "firstName": "ESL One",
                "lastName": "Tester"
              },
              "age": "55",
              "birthDate": "1960-05-13",
              "gender": "F",
              "nationality": "USA"
            },
            "address": {
              "address1": "addr1",
              "city": "Miramar",
              "stateCode": "FL",
              "postalCode": "33029",
              "countryName": "USA"
            },
            "email": "eslqa@rccl.com"
          }
        },
        {
          "guestContact": {
            "guestRefNumber": "0",
            "personalInfo": {
              "name": {
                "title": "MR",
                "firstName": "ESL Two",
                "lastName": "Tester"
              },
              "age": "55",
              "birthDate": "1960-05-13",
              "gender": "M",
              "nationality": "USA"
            },
            "address": {
              "address1": "addr1",
              "city": "Miramar",
              "stateCode": "NA",
              "postalCode": "33029",
              "countryName": "USA"
            },
            "email": "eslqa@rccl.com"
          }
        }
      ]
    }
  ],
  "courtesyHold": "true"
}</con:request>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/createBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="2246d26e-df78-4848-99de-da9397acacc5" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0d3b6e1f-409b-4e9f-817c-e7d957524669" name="Validate Booking ID not null">
              <con:configuration>
                <scriptText>def jsonRes = messageExchange.getResponse().contentAsString


def jsonSlurper = new groovy.json.JsonSlurper();
def parse = jsonSlurper.parseText(jsonRes)


def bookingId = parse.bookingConfirmation.bookingId
log.info bookingId
assert bookingId!=null</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_lastname/booking" id="0a515545-56d1-44f0-b780-88aae472ed5d">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import groovy.json.*
import groovy.util.*


def ts = testRunner.testCase.getTestStepByName("createBooking");

def xml = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));
log.info(xml)

def json = new JsonSlurper().parseText(ts.getPropertyValue("RawRequest"));
log.info(json)


//Set Test Case Booking ID
def booking  = xml.bookingConfirmation.bookingId.text()
log.info(booking)
testRunner.testCase.setPropertyValue("bookingId",booking);


//Set Test Case lastName
def lastname = json.reservations[0].guestDetails[0].guestContact.personalInfo.name.lastName
log.info(lastname)
testRunner.testCase.setPropertyValue("lastname",lastname);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="delay" name="Delay" id="48ecea69-3c73-4259-b80f-d4be14dee573">
        <con:settings/>
        <con:config>
          <delay>2000</delay>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrieveBooking" id="fc2b16ca-e553-485e-8009-37ddc223d4f1">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveBooking" resourcePath="/rest/v3/retrieveBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveBooking" id="5233383c-3985-4305-ab02-2225af0d0e20" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="aa751c95-8f3c-46fc-b1a0-39d195e9727d" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" name="Contains" id="836cc23a-febd-410e-a3d5-c136bb4303e9">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="8d2c2110-d9ab-4d1b-9a6e-cbe94da21f3a" name="Validate accessToken is not null">
              <con:configuration>
                <scriptText>def jsonRes = messageExchange.getResponse().contentAsString


def jsonSlurper = new groovy.json.JsonSlurper();
def parse = jsonSlurper.parseText(jsonRes)


def token = parse.bookingAccessToken
log.info token
assert token!=null</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="lastName" value="${#TestCase#lastname}"/>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="summaryRequested" value="FALSE"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_RES_bookingAccessToken" id="79c1dfee-27d5-4010-8f17-c155d6f5bb7d">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import groovy.json.*
import groovy.util.*


def ts = testRunner.testCase.getTestStepByName("retrieveBooking");

def xml = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));
log.info(xml)


//Set Test Case bookingAccessToken
def bookingAccessToken  = xml.bookingAccessToken.text()
log.info(bookingAccessToken)
testRunner.testCase.setPropertyValue("bookingAccessToken",bookingAccessToken);</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="releaseBooking" id="f24964e6-1002-4ba9-8098-08228d3b138b">
        <con:settings/>
        <con:config service="Booking" methodName="releaseBooking" resourcePath="/rest/v3/releaseBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="releaseBooking" id="de6517cc-b30f-416b-9427-21d29356bb6d" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/releaseBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="be37509b-9000-4ee0-a8b1-67535b72db92" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="ed9d1312-71d3-4bf7-b5be-f34affb3d475" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="Data Source Loop" id="7e828898-3c15-417a-b9f4-9d8c7129127f">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>cruiseSearch</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>PackageCode</con:name>
          <con:value>OA10E019</con:value>
        </con:property>
        <con:property>
          <con:name>TestShip</con:name>
          <con:value>AX</con:value>
        </con:property>
        <con:property>
          <con:name>shipCode</con:name>
          <con:value>OA</con:value>
        </con:property>
        <con:property>
          <con:name>sailDate</con:name>
          <con:value>2023-01-05</con:value>
        </con:property>
        <con:property>
          <con:name>brand</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>fareCode</con:name>
          <con:value>I1614879</con:value>
        </con:property>
        <con:property>
          <con:name>categoryCode</con:name>
          <con:value>4V</con:value>
        </con:property>
        <con:property>
          <con:name>cabinNumber</con:name>
          <con:value>8400</con:value>
        </con:property>
        <con:property>
          <con:name>seatingCd</con:name>
          <con:value>O</con:value>
        </con:property>
        <con:property>
          <con:name>seatingTime</con:name>
          <con:value>MY TIME</con:value>
        </con:property>
        <con:property>
          <con:name>application</con:name>
          <con:value>royalcaribbean.com</con:value>
        </con:property>
        <con:property>
          <con:name>country</con:name>
          <con:value>MEX</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value>MXN</con:value>
        </con:property>
        <con:property>
          <con:name>bookingID</con:name>
          <con:value>1305952</con:value>
        </con:property>
        <con:property>
          <con:name>lastname</con:name>
          <con:value>Tester</con:value>
        </con:property>
        <con:property>
          <con:name>bookingAccessToken</con:name>
          <con:value>fa143a24-b7d5-4bb9-bed5-7be9c6f4a7db</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="d8d03357-199c-46ea-9928-fd8caed09c5c" name="Cruise Search_TestSuite">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="2c222404-77ec-4073-9eb4-587acb91f464" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="cruiseSearch - Validate resultsPreference.groupBy PACKAGE" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="restrequest" name="CruiseSearch" id="5d9aaa0a-b2ab-403a-a871-436b017586e7">
        <con:settings/>
        <con:config service="Cruise Search" resourcePath="/esl/search/rest/cruiseSearch" methodName="cruiseSearch" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="CruiseSearch" id="3efd27a3-c060-4ccb-8337-cd10c6b4e444" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>http://eslaservicestst01.rccl.com/esl/booking/tst2/esl/search/rest/cruiseSearch</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0b9832ee-4503-4970-9ddc-5563fb1084b7" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Validate" id="2f4cf9ff-cc77-4d87-ab51-cc131e10137f">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import groovy.json.JsonSlurper
import com.eviware.soapui.settings.SSLSettings
import com.eviware.soapui.SoapUI 


def ts = testRunner.testCase.getTestStepByName("CruiseSearch");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

int  totalHits = (res.resultsSummary.totalHits.text()).toInteger()
int countItineraries = res.resultsByPackage.packageSummaryWithClassLevelPricing.size()


assert totalHits==countItineraries


for(i=0; i&lt;=countItineraries-1;i++){
	def getPackage = res.resultsByPackage.packageSummaryWithClassLevelPricing[i].packageReference.@code.text()
	log.info('PACKAGE: '+getPackage)
	
	int sailings = res.resultsByPackage.packageSummaryWithClassLevelPricing[i].cabinClassPriceBySailing.size()
	log.info('SIZE: '+sailings)
		
			for(x=0; x&lt;=sailings-1;x++){
				//def getSailingPackage = res.resultsByPackage.packageSummaryWithClassLevelPricing.cabinClassPriceBySailing[i].sailingRef[x].@package.text()
				def getSailingPackage = res.resultsByPackage.packageSummaryWithClassLevelPricing[i].cabinClassPriceBySailing[x].sailingRef.@package.text()
				log.info('Packages inside ClassPriceBySailing: : '+getSailingPackage)
				assert getPackage==getSailingPackage
			}

	}</script>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="c0e5b982-e333-44a8-b841-ee74c0f9401d" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="cruiseSearch - Validate resultsPreference.groupBy ITINERARY" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="restrequest" name="CruiseSearch" id="8a354a7c-bd99-444d-9718-bc8e3701bf2f">
        <con:settings/>
        <con:config service="Cruise Search" resourcePath="/esl/search/rest/cruiseSearch" methodName="cruiseSearch" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="CruiseSearch" id="3efd27a3-c060-4ccb-8337-cd10c6b4e444" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>http://eslaservicestst01.rccl.com/esl/booking/tst2/esl/search/rest/cruiseSearch</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0b9832ee-4503-4970-9ddc-5563fb1084b7" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Validate" id="45f55d54-fc68-458c-8182-1d715dbf0e32">
        <con:settings/>
        <con:config>
          <script>import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import groovy.json.JsonSlurper
import com.eviware.soapui.settings.SSLSettings
import com.eviware.soapui.SoapUI 


def ts = testRunner.testCase.getTestStepByName("CruiseSearch");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

int  totalHits = (res.resultsSummary.totalHits.text()).toInteger()
int countItineraries = res.resultsByPackage.packageSummaryWithClassLevelPricing.size()

assert totalHits==countItineraries


for(i=0; i&lt;=countItineraries-1;i++){
	def getPackage = res.resultsByPackage.packageSummaryWithClassLevelPricing[i].packageReference.@code.text()
	log.info('PACKAGE: '+getPackage)
	
	int sailings = res.resultsByPackage.packageSummaryWithClassLevelPricing[i].cabinClassPriceBySailing.size()
	log.info('SIZE: '+sailings)
		
			for(x=0; x&lt;=sailings-1;x++){
				def getSailingPackage = res.resultsByPackage.packageSummaryWithClassLevelPricing[i].cabinClassPriceBySailing[x].sailingRef.@package.text()
				log.info('Packages inside ClassPriceBySailing: '+getSailingPackage)
				//assert getPackage==getSailingPackage
				def shipNight = getPackage[0..3]
				log.info('String:'+ shipNight)

				assert getSailingPackage.contains(shipNight)
			}

	}</script>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="54cad034-b66c-4a8c-8ba6-e2cd29c7872d" name="Booking Service_TestSuite">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="62a7c6ce-f07e-450b-856c-3edde177abe2" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="retrievePaymentHistory - validate payment details - partial payment" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="restrequest" name="retrieveBooking" id="c04c3ed8-a66a-4180-89c5-c9c348734378">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveBooking" resourcePath="/rest/v3/retrieveBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveBooking" id="10f924f2-016e-4ed3-bc53-2e8b33485541" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="ded6ce8d-e27f-45ce-bae7-96c88e54b188" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="b5452861-7994-47b8-8329-d5fd1ee9810d" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="lastName" value="ESL"/>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="lockBooking" value="TRUE"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="summaryRequested" value="FALSE"/>
              <con:entry key="header.brand" value="R"/>
              <con:entry key="sailDate" value="2023-07-14"/>
              <con:entry key="bookingId" value="544872"/>
              <con:entry key="shipCode" value="AN"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_properties" id="61d092bb-295a-41e7-9d97-5b60054ed0c7">
        <con:settings/>
        <con:config>
          <script><![CDATA[import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import org.apache.commons.lang3.StringUtils;


def ts = testRunner.testCase.getTestStepByName("retrieveBooking");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Package Code
def bookingAccessToken = res.bookingAccessToken.text()
log.info(bookingAccessToken)
testRunner.testCase.setPropertyValue("bookingAccessToken",bookingAccessToken);




String  url =  ts.getHttpRequest().getResponse().getURL(); 
log.info(url)

String app = StringUtils.substringBetween(url, "header.application=", "&");
log.info(app)
testRunner.testCase.setPropertyValue("application",app);

String brand = StringUtils.substringBetween(url, "header.brand=", "&");
log.info(brand)
testRunner.testCase.setPropertyValue("brand",brand);


String country = StringUtils.substringBetween(url, "countryCode=", "&");
log.info(country)
testRunner.testCase.setPropertyValue("country",country);

String bookingId = StringUtils.substringBetween(url, "bookingId=", "&");
log.info(bookingId)
testRunner.testCase.setPropertyValue("bookingId",bookingId);


String shipCode = StringUtils.substringBetween(url, "shipCode=", "&");
log.info(shipCode)
testRunner.testCase.setPropertyValue("shipCode",shipCode);

String sailDate = StringUtils.substringBetween(url, "sailDate=", "&");
log.info(sailDate)
testRunner.testCase.setPropertyValue("sailDate",sailDate);]]></script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrievePaymentHistory" id="6ad8818f-90c6-4566-a236-f3f78e1a56d0">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/retrievePaymentHistory" methodName="retrievePaymentHistory" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrievePaymentHistory" id="6d030ab9-443b-40f4-9569-df98b15dd373" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst1/rest/v3/retrievePaymentHistory</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="09d8dde0-31a9-49a3-9890-60b571911fbc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="fe62545e-878c-41c5-a3c3-937b532478a1" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="5d291a77-8b03-48ba-9018-7d099d605d81" name="Script Assertion - Validate Payment Details">
              <con:configuration>
                <scriptText><![CDATA[def jsonRes = messageExchange.getResponse().contentAsString
def jsonSlurper = new groovy.json.JsonSlurper();
def parse = jsonSlurper.parseText(jsonRes)
log.info parse

//Get number of payments
def count = parse.paymentDetail.size()
log.info count

def getTotal= 0
for ( i=0; i<=count-1;i++){
		//Check visibility of payment details
		def givenName = parse.paymentDetail[i].givenName
		assert (givenName != null) && (givenName != "") && (givenName != []); 
		log.info givenName

		def surName = parse.paymentDetail[i].surName
		assert (surName != null) && (surName != "") && (surName != []); 
		log.info surName
		
		def currency = parse.paymentDetail[i].currency
		assert (currency != null) && (currency != "") && (currency != []); 
		log.info currency
		
		def paymentAmount = parse.paymentDetail[i].paymentAmount
		assert (paymentAmount != null) && (paymentAmount != "") && (paymentAmount != []); 
		log.info paymentAmount
		
		def paymentType = parse.paymentDetail[i].paymentType
		assert (paymentType != null) && (paymentType != "") && (paymentType != []); 
		log.info paymentType
		
		def paymentDate = parse.paymentDetail[i].paymentDate
		assert (paymentDate != null) && (paymentDate != "") && (paymentDate != []); 
		log.info paymentDate
		
		def paymentTime = parse.paymentDetail[i].paymentTime
		assert (paymentTime != null) && (paymentTime != "") && (paymentTime != []); 
		log.info paymentTime

		//Get total of paymentAmount
		def payment = (parse.paymentDetail[i].paymentAmount).toDouble()
		log.info payment

			 getTotal = (getTotal + payment).round(2)
			log.info getTotal
	
}

def totalAmount = parse.totalAmount.toDouble()
def totalPaidAmount = parse.totalPaidAmount.toDouble()
def balanceDue = parse.balanceDue.toDouble()
def difference = totalAmount-totalPaidAmount

assert totalAmount != totalPaidAmount
assert getTotal==totalPaidAmount
assert difference==balanceDue]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="releaseBooking" id="cc7b059a-c011-44f6-ae10-d1e716ad4cc2">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/releaseBooking" methodName="releaseBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="releaseBooking" id="e0135d9d-6b24-4332-996d-3f8c56b32255" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Accept" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst1/rest/v3/releaseBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="5b666fdb-dd17-4ada-a7b9-a40eaa3d1d0a" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>bookingAccessToken</con:name>
          <con:value>b79002b9-6491-4c71-8bad-6a73ae12b2c1</con:value>
        </con:property>
        <con:property>
          <con:name>application</con:name>
          <con:value>royalcaribbean.com</con:value>
        </con:property>
        <con:property>
          <con:name>country</con:name>
          <con:value>USA</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>brand</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>bookingId</con:name>
          <con:value>544872</con:value>
        </con:property>
        <con:property>
          <con:name>shipCode</con:name>
          <con:value>AN</con:value>
        </con:property>
        <con:property>
          <con:name>sailDate</con:name>
          <con:value>2023-07-14</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="5f77ebde-e1f5-4272-8158-0d9ad673214d" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="retrievePaymentHistory - validate payment details - full payment" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="restrequest" name="retrieveBooking" id="102052cd-7ce5-45bb-b1f8-8852ccb4a6ea">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveBooking" resourcePath="/rest/v3/retrieveBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveBooking" id="10f924f2-016e-4ed3-bc53-2e8b33485541" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="ded6ce8d-e27f-45ce-bae7-96c88e54b188" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="b5452861-7994-47b8-8329-d5fd1ee9810d" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="lastName" value="Mendoza"/>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="lockBooking" value="TRUE"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="summaryRequested" value="FALSE"/>
              <con:entry key="header.brand" value="R"/>
              <con:entry key="sailDate" value="2023-04-29"/>
              <con:entry key="bookingId" value="0544769"/>
              <con:entry key="shipCode" value="BR"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_properties" id="c1161a90-56c0-4f88-93f4-3980bcb551d4">
        <con:settings/>
        <con:config>
          <script><![CDATA[import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import org.apache.commons.lang3.StringUtils;


def ts = testRunner.testCase.getTestStepByName("retrieveBooking");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Package Code
def bookingAccessToken = res.bookingAccessToken.text()
log.info(bookingAccessToken)
testRunner.testCase.setPropertyValue("bookingAccessToken",bookingAccessToken);




String  url =  ts.getHttpRequest().getResponse().getURL(); 
log.info(url)

String app = StringUtils.substringBetween(url, "header.application=", "&");
log.info(app)
testRunner.testCase.setPropertyValue("application",app);

String brand = StringUtils.substringBetween(url, "header.brand=", "&");
log.info(brand)
testRunner.testCase.setPropertyValue("brand",brand);


String country = StringUtils.substringBetween(url, "countryCode=", "&");
log.info(country)
testRunner.testCase.setPropertyValue("country",country);

String bookingId = StringUtils.substringBetween(url, "bookingId=", "&");
log.info(bookingId)
testRunner.testCase.setPropertyValue("bookingId",bookingId);


String shipCode = StringUtils.substringBetween(url, "shipCode=", "&");
log.info(shipCode)
testRunner.testCase.setPropertyValue("shipCode",shipCode);

String sailDate = StringUtils.substringBetween(url, "sailDate=", "&");
log.info(sailDate)
testRunner.testCase.setPropertyValue("sailDate",sailDate);]]></script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrievePaymentHistory" id="41cf80c8-0789-423e-96c2-98cec00efb97">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/retrievePaymentHistory" methodName="retrievePaymentHistory" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrievePaymentHistory" id="6d030ab9-443b-40f4-9569-df98b15dd373" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst1/rest/v3/retrievePaymentHistory</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="09d8dde0-31a9-49a3-9890-60b571911fbc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="fe62545e-878c-41c5-a3c3-937b532478a1" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="5d291a77-8b03-48ba-9018-7d099d605d81" name="Script Assertion - Validate Payment Details">
              <con:configuration>
                <scriptText><![CDATA[def jsonRes = messageExchange.getResponse().contentAsString
def jsonSlurper = new groovy.json.JsonSlurper();
def parse = jsonSlurper.parseText(jsonRes)
log.info parse

//Get number of payments
def count = parse.paymentDetail.size()
log.info count

def getTotal= 0
for ( i=0; i<=count-1;i++){
		//Check visibility of payment details
		def givenName = parse.paymentDetail[i].givenName
		assert (givenName != null) && (givenName != "") && (givenName != []); 
		log.info givenName

		def surName = parse.paymentDetail[i].surName
		assert (surName != null) && (surName != "") && (surName != []); 
		log.info surName
		
		def currency = parse.paymentDetail[i].currency
		assert (currency != null) && (currency != "") && (currency != []); 
		log.info currency
		
		def paymentAmount = parse.paymentDetail[i].paymentAmount
		assert (paymentAmount != null) && (paymentAmount != "") && (paymentAmount != []); 
		log.info paymentAmount
		
		def paymentType = parse.paymentDetail[i].paymentType
		assert (paymentType != null) && (paymentType != "") && (paymentType != []); 
		log.info paymentType
		
		def paymentDate = parse.paymentDetail[i].paymentDate
		assert (paymentDate != null) && (paymentDate != "") && (paymentDate != []); 
		log.info paymentDate
		
		def paymentTime = parse.paymentDetail[i].paymentTime
		assert (paymentTime != null) && (paymentTime != "") && (paymentTime != []); 
		log.info paymentTime

		//Get total of paymentAmount
		def payment = (parse.paymentDetail[i].paymentAmount).toDouble()
		log.info payment

			 getTotal = (getTotal + payment).round(2)
			log.info getTotal
	
}

def totalAmount = parse.totalAmount.toDouble()
def totalPaidAmount = parse.totalPaidAmount.toDouble()
def balanceDue = parse.balanceDue.toDouble()
def difference = totalAmount-totalPaidAmount

assert totalAmount == totalPaidAmount
assert getTotal==totalPaidAmount
assert balanceDue==0.0]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="releaseBooking" id="d8617e56-cee1-463b-b8f8-b959472b40cd">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/releaseBooking" methodName="releaseBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="releaseBooking" id="e0135d9d-6b24-4332-996d-3f8c56b32255" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Accept" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst1/rest/v3/releaseBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="c9b6aeae-c583-4740-ba65-e0dcb8b19c0d" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>bookingAccessToken</con:name>
          <con:value>e0e67ee8-4fe6-414b-b2f4-94300b12c65a</con:value>
        </con:property>
        <con:property>
          <con:name>application</con:name>
          <con:value>royalcaribbean.com</con:value>
        </con:property>
        <con:property>
          <con:name>country</con:name>
          <con:value>USA</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>brand</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>bookingId</con:name>
          <con:value>0544769</con:value>
        </con:property>
        <con:property>
          <con:name>shipCode</con:name>
          <con:value>BR</con:value>
        </con:property>
        <con:property>
          <con:name>sailDate</con:name>
          <con:value>2023-04-29</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="dd9c7179-6af9-4115-91a1-b63cf148437c" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="retrievePaymentHistory - validate payment details - courtesy hold" searchProperties="true" timeout="0">
      <con:settings/>
      <con:testStep type="restrequest" name="retrieveBooking" id="0502b439-0ffb-4211-9804-4a5f1a1431ea">
        <con:settings/>
        <con:config service="Booking" methodName="retrieveBooking" resourcePath="/rest/v3/retrieveBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrieveBooking" id="10f924f2-016e-4ed3-bc53-2e8b33485541" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst2/rest/v3/retrieveBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="ded6ce8d-e27f-45ce-bae7-96c88e54b188" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="b5452861-7994-47b8-8329-d5fd1ee9810d" name="Contains">
              <con:configuration>
                <token>Success</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="lastName" value="Test"/>
              <con:entry key="header.language" value="en_US"/>
              <con:entry key="header.domainId" value="1"/>
              <con:entry key="summaryRequested" value="FALSE"/>
              <con:entry key="header.brand" value="R"/>
              <con:entry key="sailDate" value="2023-06-16"/>
              <con:entry key="bookingId" value="544591"/>
              <con:entry key="shipCode" value="AN"/>
            </con:parameters>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Fetch_properties" id="b3913f1c-4a0f-45ae-a015-471e822b8b51">
        <con:settings/>
        <con:config>
          <script><![CDATA[import java.io.*;
import java.util.*;
import com.eviware.soapui.model.testsuite.*;
import com.eviware.soapui.impl.wsdl.teststeps.assertions.*;
import org.apache.commons.lang3.StringUtils;


def ts = testRunner.testCase.getTestStepByName("retrieveBooking");
def res = new XmlSlurper().parseText(ts.getPropertyValue("ResponseAsXml"));

//Set Test Case Package Code
def bookingAccessToken = res.bookingAccessToken.text()
log.info(bookingAccessToken)
testRunner.testCase.setPropertyValue("bookingAccessToken",bookingAccessToken);




String  url =  ts.getHttpRequest().getResponse().getURL(); 
log.info(url)

String app = StringUtils.substringBetween(url, "header.application=", "&");
log.info(app)
testRunner.testCase.setPropertyValue("application",app);

String brand = StringUtils.substringBetween(url, "header.brand=", "&");
log.info(brand)
testRunner.testCase.setPropertyValue("brand",brand);


String country = StringUtils.substringBetween(url, "countryCode=", "&");
log.info(country)
testRunner.testCase.setPropertyValue("country",country);

String bookingId = StringUtils.substringBetween(url, "bookingId=", "&");
log.info(bookingId)
testRunner.testCase.setPropertyValue("bookingId",bookingId);


String shipCode = StringUtils.substringBetween(url, "shipCode=", "&");
log.info(shipCode)
testRunner.testCase.setPropertyValue("shipCode",shipCode);

String sailDate = StringUtils.substringBetween(url, "sailDate=", "&");
log.info(sailDate)
testRunner.testCase.setPropertyValue("sailDate",sailDate);]]></script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="retrievePaymentHistory" id="2db90263-edea-4ec1-b7a9-a8627af6e32e">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/retrievePaymentHistory" methodName="retrievePaymentHistory" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="retrievePaymentHistory" id="6d030ab9-443b-40f4-9569-df98b15dd373" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst1/rest/v3/retrievePaymentHistory</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="09d8dde0-31a9-49a3-9890-60b571911fbc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Simple Contains" id="fe62545e-878c-41c5-a3c3-937b532478a1" name="Contains">
              <con:configuration>
                <token>Failure</token>
                <ignoreCase>false</ignoreCase>
                <useRegEx>false</useRegEx>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="sailDate" value="${#TestCase#sailDate}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
              <con:entry key="shipCode" value="${#TestCase#shipCode}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="releaseBooking" id="90da7d08-b411-4b65-88d4-06e204548df5">
        <con:settings/>
        <con:config service="Booking" resourcePath="/rest/v3/releaseBooking" methodName="releaseBooking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="releaseBooking" id="e0135d9d-6b24-4332-996d-3f8c56b32255" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment>&lt;con:entry key="Accept" value="application/json" xmlns:con="http://eviware.com/soapui/config"/>&lt;con:entry key="AppKey" value="bjnm9J1yJjsQQLqQ8H1ffKtDAv3kQohG" xmlns:con="http://eviware.com/soapui/config"/>&lt;/xml-fragment></con:setting>
            </con:settings>
            <con:request/>
            <con:originalUri>https://tst1-int.api.rccl.com/esl/booking/tst1/rest/v3/releaseBooking</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="67fb114c-31c8-4ea8-a2cc-156e19d25a8c" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="header.application" value="${#TestCase#application}"/>
              <con:entry key="countryCode" value="${#TestCase#country}"/>
              <con:entry key="bookingAccessToken" value="${#TestCase#bookingAccessToken}"/>
              <con:entry key="header.brand" value="${#TestCase#brand}"/>
              <con:entry key="bookingId" value="${#TestCase#bookingId}"/>
            </con:parameters>
            <con:environmentSpec>
              <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>bookingAccessToken</con:name>
          <con:value>1981179a-38cf-4e04-a2d0-30b955cafa91</con:value>
        </con:property>
        <con:property>
          <con:name>application</con:name>
          <con:value>royalcaribbean.com</con:value>
        </con:property>
        <con:property>
          <con:name>country</con:name>
          <con:value>USA</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>brand</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>bookingId</con:name>
          <con:value>544591</con:value>
        </con:property>
        <con:property>
          <con:name>shipCode</con:name>
          <con:value>AN</con:value>
        </con:property>
        <con:property>
          <con:name>sailDate</con:name>
          <con:value>2023-06-16</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:environmentSpec>
        <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:requirements/>
  <con:properties>
    <con:property>
      <con:name>AppKey</con:name>
    </con:property>
  </con:properties>
  <con:wssContainer/>
  <con:databaseConnectionContainer/>
  <con:jmsConnectionContainer/>
  <con:oAuth2ProfileContainer/>
  <con:oAuth1ProfileContainer/>
  <con:reporting>
    <con:xmlTemplates/>
    <con:parameters/>
  </con:reporting>
  <con:eventHandlers type="RequestFilter.filterRequest" name="RequestFilter.filterRequest">
    <con:script>// Sample event script to add custom HTTP header to all outgoing REST, SOAP and HTTP(S) calls
// This code is often used for adding custom authentication to ReadyAPI functional tests

// If hardcoding the token, uncomment and change line 5
// token = '4567'

// If your token is parameterized in Project level custom property, uncomment line 8
// token = request.parent.testCase.testSuite.project.getProperty('auth_token').getValue()

// To modify all outgoing calls, remove comments from lines 11 to 16
// headers = request.requestHeaders
// if (headers.containsKey('auth_token2') == false) {
//   headers.put('auth_token2', token)
//   request.requestHeaders = headers
// }</con:script>
  </con:eventHandlers>
  <con:eventHandlers type="TestRunListener.afterStep" name="TestRunListener.afterStep">
    <con:script>// Save all test step results into files
// Change the directory path in line 5 to a location where you want to store details
// then uncomment lines 5 to 10

// filePath = 'C:\\tempOutputDirectory\\'
// fos = new java.io.FileOutputStream(filePath + testStepResult.testStep.label + '.txt', true)
// pw = new java.io.PrintWriter(fos)
// testStepResult.writeTo(pw)
// pw.close()
// fos.close()</con:script>
  </con:eventHandlers>
  <con:environment id="1e8db791-2cca-4d3a-9451-5c9a433740b4" name="RLE" index="0">
    <con:service type="REST" name="Cruise Search">
      <con:endpoint authProfile="No Authorization" proxyHost="" proxyPort="" proxyUsername="" proxyPassword="">http://eslaservicestst01.rccl.com:13030</con:endpoint>
    </con:service>
    <con:service type="REST" name="Booking">
      <con:endpoint authProfile="No Authorization" proxyHost="" proxyPort="" proxyUsername="" proxyPassword="">https://tst1-int.api.rccl.com/esl/booking/tst2</con:endpoint>
    </con:service>
    <con:property>
      <con:name>AppKey</con:name>
      <con:value>ZJCQR5Gf2v7I5zaz8jtOGGe3sbTXMcJp</con:value>
    </con:property>
    <con:databaseConnectionContainer/>
    <con:jmsConnectionContainer/>
  </con:environment>
  <con:environment id="c3a4b580-ecc4-4d69-9e64-f4e9abf07977" name="RLC" index="1">
    <con:service type="REST" name="Cruise Search">
      <con:endpoint authProfile="No Authorization" proxyHost="" proxyPort="" proxyUsername="" proxyPassword="">http://eslaservicestst01.rccl.com:13000</con:endpoint>
    </con:service>
    <con:service type="REST" name="Booking">
      <con:endpoint authProfile="No Authorization" proxyHost="" proxyPort="" proxyUsername="" proxyPassword="">https://tst1-int.api.rccl.com/esl/booking/tst1</con:endpoint>
    </con:service>
    <con:property>
      <con:name>AppKey</con:name>
      <con:value/>
    </con:property>
    <con:databaseConnectionContainer/>
    <con:jmsConnectionContainer/>
  </con:environment>
  <con:authRepository/>
  <con:environmentSpec>
    <con:entry environmentId="1e8db791-2cca-4d3a-9451-5c9a433740b4">
      <con:authProfile>No Authorization</con:authProfile>
    </con:entry>
    <con:entry environmentId="c3a4b580-ecc4-4d69-9e64-f4e9abf07977">
      <con:authProfile>No Authorization</con:authProfile>
    </con:entry>
  </con:environmentSpec>
  <con:tags/>
</con:soapui-project>
